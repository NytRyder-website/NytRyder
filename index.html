<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nyt Ryder - After Hours E-Hailing in Eastern Cape</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%236a5af9'/%3E%3Ctext x='50' y='65' font-family='Arial, sans-serif' font-size='50' font-weight='bold' text-anchor='middle' fill='white'%3ENR%3C/text%3E%3C/svg%3E">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0f1a30;
            --secondary: #1a2b4d;
            --accent: #6a5af9;
            --accent-light: #8a7dfa;
            --text: #f0f0f0;
            --text-secondary: #b0b0b0;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --radius: 12px;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--primary);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        h1, h2, h3, h4, h5 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            line-height: 1.3;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header & Navigation */
        header {
            background-color: var(--primary);
            padding: 15px 0;
            position: fixed;
            width: 100%;
            z-index: 1000;
            box-shadow: var(--shadow);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            border-radius: 50%;
            font-size: 20px;
            font-weight: 800;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .logo::after {
            content: '';
            position: absolute;
            width: 25px;
            height: 25px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            top: -3px;
            right: -3px;
        }
        
        .logo-text {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            font-weight: 800;
            color: white;
            letter-spacing: 1px;
        }
        
        .logo-text span {
            color: var(--accent);
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 30px;
            align-items: center;
        }
        
        nav a {
            color: var(--text);
            text-decoration: none;
            font-weight: 500;
            font-size: 16px;
            transition: var(--transition);
            padding: 8px 0;
            position: relative;
        }
        
        nav a:hover {
            color: var(--accent);
        }
        
        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--accent);
            transition: var(--transition);
        }
        
        nav a:hover::after {
            width: 100%;
        }
        
        .user-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-btn {
            padding: 10px 20px;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 14px;
        }
        
        .login-btn {
            background-color: transparent;
            color: var(--text);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .login-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .register-btn {
            background: linear-gradient(to right, var(--accent), var(--accent-light));
            color: white;
        }
        
        .register-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(106, 90, 249, 0.4);
        }
        
        .admin-header-btn {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 2px solid rgba(245, 158, 11, 0.3);
            padding: 10px 20px;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-left: 10px;
        }
        
        .admin-header-btn:hover {
            background-color: rgba(245, 158, 11, 0.2);
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: var(--radius);
            background-color: rgba(255, 255, 255, 0.05);
            transition: var(--transition);
            position: relative;
        }
        
        .user-profile:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            overflow: hidden;
        }
        
        .user-avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        .user-avatar-initials {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            color: white;
            font-weight: 600;
        }
        
        .user-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--secondary);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            min-width: 200px;
            display: none;
            z-index: 1001;
            overflow: hidden;
        }
        
        .user-menu.active {
            display: block;
        }
        
        .user-menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
        }
        
        .user-menu-item:last-child {
            border-bottom: none;
        }
        
        .user-menu-item:hover {
            background-color: rgba(106, 90, 249, 0.1);
            color: var(--accent);
        }
        
        .admin-login-btn {
            color: var(--warning);
            background-color: rgba(245, 158, 11, 0.1);
        }
        
        .admin-login-btn:hover {
            background-color: rgba(245, 158, 11, 0.2);
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            z-index: 1001;
        }
        
        /* Mobile Navigation */
        .mobile-nav {
            position: fixed;
            top: 80px;
            left: 0;
            width: 100%;
            background-color: var(--primary);
            padding: 20px;
            box-shadow: var(--shadow);
            transform: translateY(-100%);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 999;
        }
        
        .mobile-nav.active {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }
        
        .mobile-nav ul {
            list-style: none;
        }
        
        .mobile-nav li {
            width: 100%;
        }
        
        .mobile-nav a {
            display: block;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }
        
        .mobile-nav a:hover {
            color: var(--accent);
            padding-left: 10px;
        }
        
        .mobile-nav li:last-child a {
            border-bottom: none;
        }
        
        .mobile-admin-login {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .mobile-admin-btn {
            width: 100%;
            padding: 12px;
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 2px solid rgba(245, 158, 11, 0.3);
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .mobile-admin-btn:hover {
            background-color: rgba(245, 158, 11, 0.2);
            transform: translateY(-2px);
        }
        
        /* Auth Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .auth-modal {
            background-color: var(--secondary);
            border-radius: var(--radius);
            width: 90%;
            max-width: 500px;
            padding: 30px;
            box-shadow: var(--shadow);
            transform: translateY(30px);
            transition: var(--transition);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-overlay.active .auth-modal {
            transform: translateY(0);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 1.5rem;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .close-modal:hover {
            color: var(--accent);
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .auth-tab {
            padding: 12px 20px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            transition: var(--transition);
        }
        
        .auth-tab.active {
            color: var(--accent);
        }
        
        .auth-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--accent);
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 14px;
            border-radius: var(--radius);
            border: 1px solid rgba(255, 255, 255, 0.1);
            background-color: rgba(255, 255, 255, 0.05);
            color: var(--text);
            font-size: 14px;
            transition: var(--transition);
            resize: vertical;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(106, 90, 249, 0.2);
        }
        
        .phone-input-group {
            display: flex;
            gap: 10px;
        }
        
        .phone-prefix {
            flex: 0 0 80px;
        }
        
        .phone-number {
            flex: 1;
        }
        
        .profile-picture-upload {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .profile-preview {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid var(--accent);
        }
        
        .profile-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .upload-controls {
            flex: 1;
        }
        
        .upload-btn {
            background-color: rgba(106, 90, 249, 0.2);
            color: var(--accent);
            border: 1px solid var(--accent);
            padding: 8px 15px;
            border-radius: var(--radius);
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
            margin-bottom: 10px;
            display: inline-block;
        }
        
        .upload-btn:hover {
            background-color: rgba(106, 90, 249, 0.3);
        }
        
        .submit-btn {
            background: linear-gradient(to right, var(--accent), var(--accent-light));
            color: white;
            border: none;
            width: 100%;
            padding: 16px;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(106, 90, 249, 0.3);
        }
        
        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Admin Login Modal */
        .admin-modal {
            background-color: var(--secondary);
            border-radius: var(--radius);
            width: 90%;
            max-width: 400px;
            padding: 30px;
            box-shadow: var(--shadow);
            transform: translateY(30px);
            transition: var(--transition);
        }
        
        .modal-overlay.active .admin-modal {
            transform: translateY(0);
        }
        
        .admin-note {
            background-color: rgba(245, 158, 11, 0.1);
            border-radius: var(--radius);
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid var(--warning);
            font-size: 14px;
        }
        
        .admin-note i {
            color: var(--warning);
        }
        
        /* Driver Registration */
        .driver-commission {
            background-color: rgba(245, 158, 11, 0.1);
            border-radius: var(--radius);
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid var(--warning);
            font-size: 14px;
        }
        
        .commission-rate {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--warning);
            text-align: center;
            margin: 10px 0;
        }
        
        /* Hero Section */
        .hero {
            padding: 150px 0 80px;
            background: linear-gradient(rgba(15, 26, 48, 0.9), rgba(15, 26, 48, 0.95)), url('https://images.unsplash.com/photo-1544636331-e26879cd4d9b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            text-align: center;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .hero p {
            font-size: 1rem;
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto 30px;
        }
        
        .accent-text {
            color: var(--accent);
            font-weight: 800;
        }
        
        .location-tag {
            display: inline-block;
            background-color: rgba(106, 90, 249, 0.2);
            color: var(--accent);
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: 600;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        
        .cta-button {
            display: inline-block;
            background: linear-gradient(to right, var(--accent), var(--accent-light));
            color: white;
            padding: 14px 30px;
            border-radius: var(--radius);
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            transition: var(--transition);
            box-shadow: var(--shadow);
            border: none;
            cursor: pointer;
            margin: 10px;
        }
        
        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(106, 90, 249, 0.4);
        }
        
        .cta-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 30px;
        }
        
        .cta-button.secondary {
            background: linear-gradient(to right, var(--warning), #fbbf24);
        }
        
        .cta-button.secondary:hover {
            box-shadow: 0 15px 30px rgba(245, 158, 11, 0.4);
        }
        
        /* Pricing Calculator */
        .calculator-section {
            padding: 80px 0;
            background-color: var(--secondary);
        }
        
        .section-title {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 40px;
            position: relative;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 4px;
            background-color: var(--accent);
            border-radius: 2px;
        }
        
        .calculator-container {
            background-color: var(--primary);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .calculator-notice {
            background-color: rgba(245, 158, 11, 0.1);
            border-radius: var(--radius);
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid var(--warning);
            font-size: 14px;
        }
        
        .location-group {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        .location-search-container {
            position: relative;
            margin-bottom: 20px;
        }
        
        .location-search-input {
            width: 100%;
            padding: 14px 14px 14px 40px;
            border-radius: var(--radius);
            border: 1px solid rgba(255, 255, 255, 0.1);
            background-color: rgba(255, 255, 255, 0.05);
            color: var(--text);
            font-size: 14px;
            transition: var(--transition);
        }
        
        .location-search-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(106, 90, 249, 0.2);
        }
        
        .location-search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            transition: var(--transition);
        }
        
        .location-search-input:focus + .location-search-icon {
            opacity: 0;
        }
        
        .location-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: var(--secondary);
            border-radius: 0 0 var(--radius) var(--radius);
            max-height: 300px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-top: none;
        }
        
        .location-results.active {
            display: block;
        }
        
        .location-result-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 14px;
        }
        
        .location-result-item:hover {
            background-color: rgba(106, 90, 249, 0.1);
        }
        
        .calculate-btn {
            background: linear-gradient(to right, var(--accent), var(--accent-light));
            color: white;
            border: none;
            width: 100%;
            padding: 16px;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(106, 90, 249, 0.3);
        }
        
        .calculate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .login-required {
            text-align: center;
            padding: 15px;
            background-color: rgba(239, 68, 68, 0.1);
            border-radius: var(--radius);
            margin-bottom: 20px;
            border-left: 4px solid var(--danger);
            font-size: 14px;
        }
        
        .result-container {
            margin-top: 20px;
            padding: 20px;
            background-color: rgba(16, 185, 129, 0.1);
            border-radius: var(--radius);
            border-left: 4px solid var(--success);
            display: none;
        }
        
        .result-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .result-title {
            font-size: 1.2rem;
            color: var(--success);
        }
        
        .result-price {
            font-size: 2rem;
            font-weight: 800;
            color: white;
        }
        
        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .detail-box {
            background-color: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: var(--radius);
            font-size: 14px;
        }
        
        /* Payment Methods */
        .payment-methods {
            margin: 20px 0;
        }
        
        .payment-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius);
            margin-bottom: 10px;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }
        
        .payment-option:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .payment-option.selected {
            border-color: var(--accent);
            background-color: rgba(106, 90, 249, 0.1);
        }
        
        .payment-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        
        .payment-details-text {
            flex: 1;
        }
        
        .payment-details-text h4 {
            margin-bottom: 5px;
        }
        
        .payment-details-text p {
            color: var(--text-secondary);
            font-size: 12px;
        }
        
        /* Return Trip Options */
        .return-trip-options {
            margin: 20px 0;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius);
            display: none;
        }
        
        .return-trip-options.active {
            display: block;
        }
        
        .waiting-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .waiting-option {
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }
        
        .waiting-option:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .waiting-option.selected {
            border-color: var(--accent);
            background-color: rgba(106, 90, 249, 0.1);
        }
        
        .waiting-time {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .waiting-price {
            color: var(--text-secondary);
            font-size: 12px;
        }
        
        /* Booking Confirmation */
        .booking-confirmation {
            margin-top: 20px;
            padding: 20px;
            background-color: rgba(59, 130, 246, 0.1);
            border-radius: var(--radius);
            border-left: 4px solid #3b82f6;
            display: none;
        }
        
        .booking-confirmation.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .confirmation-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .confirm-btn {
            flex: 1;
            min-width: 150px;
            padding: 14px;
            border-radius: var(--radius);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
        }
        
        .book-now-btn {
            background: linear-gradient(to right, var(--success), #34d399);
            color: white;
        }
        
        .book-now-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }
        
        .cancel-btn {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .cancel-btn:hover {
            border-color: var(--danger);
            color: var(--danger);
        }
        
        /* Contact Information Modal */
        .contact-modal {
            background-color: var(--secondary);
            border-radius: var(--radius);
            width: 90%;
            max-width: 700px;
            padding: 30px;
            box-shadow: var(--shadow);
            transform: translateY(30px);
            transition: var(--transition);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-overlay.active .contact-modal {
            transform: translateY(0);
        }
        
        .contact-info-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .contact-card {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius);
            padding: 20px;
            border-left: 4px solid var(--accent);
        }
        
        .contact-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .contact-card p {
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .payment-details-section {
            background-color: rgba(16, 185, 129, 0.1);
            border-radius: var(--radius);
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid var(--success);
        }
        
        .payment-details-section h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .bank-details {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .bank-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
        }
        
        .bank-label {
            color: var(--text-secondary);
        }
        
        .bank-value {
            font-weight: 600;
        }
        
        .booking-success {
            text-align: center;
            padding: 20px 10px;
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--success), #34d399);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 36px;
        }
        
        .booking-success h2 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--success);
        }
        
        .booking-success p {
            color: var(--text-secondary);
            margin-bottom: 20px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            font-size: 14px;
        }
        
        /* Services Section */
        .services-section {
            padding: 80px 0;
            background-color: var(--primary);
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }
        
        .service-card {
            background-color: var(--secondary);
            border-radius: var(--radius);
            padding: 30px 20px;
            text-align: center;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }
        
        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }
        
        .service-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 24px;
        }
        
        .service-card h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .service-card p {
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        /* Footer */
        footer {
            background-color: #0a1427;
            padding: 50px 0 20px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .footer-logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            font-weight: 800;
            color: white;
            margin-bottom: 15px;
        }
        
        .footer-logo span {
            color: var(--accent);
        }
        
        .footer-description {
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .social-links {
            display: flex;
            gap: 10px;
        }
        
        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background-color: var(--secondary);
            border-radius: 50%;
            color: var(--text);
            text-decoration: none;
            transition: var(--transition);
        }
        
        .social-links a:hover {
            background-color: var(--accent);
            transform: translateY(-3px);
        }
        
        .footer-heading {
            font-size: 1rem;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 8px;
        }
        
        .footer-heading::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 30px;
            height: 3px;
            background-color: var(--accent);
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: var(--transition);
            font-size: 14px;
        }
        
        .footer-links a:hover {
            color: var(--accent);
            padding-left: 5px;
        }
        
        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            font-size: 12px;
        }
        
        /* Responsive Design */
        @media (max-width: 992px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
        }
        
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
            
            nav {
                display: none;
            }
            
            .hero {
                padding: 120px 0 60px;
            }
            
            .hero h1 {
                font-size: 1.8rem;
            }
            
            .calculator-container {
                padding: 20px;
            }
            
            .result-price {
                font-size: 1.8rem;
            }
            
            .auth-modal, .contact-modal, .admin-modal {
                padding: 20px;
            }
            
            .confirmation-buttons {
                flex-direction: column;
            }
            
            .confirm-btn {
                min-width: 100%;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .cta-button {
                width: 100%;
                margin: 5px 0;
            }
            
            .admin-header-btn {
                margin-left: 5px;
                padding: 8px 15px;
                font-size: 12px;
            }
        }
        
        @media (max-width: 576px) {
            .hero h1 {
                font-size: 1.5rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .result-details {
                grid-template-columns: 1fr;
            }
            
            .contact-info-grid {
                grid-template-columns: 1fr;
            }
            
            .phone-input-group {
                flex-direction: column;
            }
            
            .phone-prefix, .phone-number {
                width: 100%;
            }
        }
        
        /* Alert System */
        .custom-alert {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 3000;
            min-width: 300px;
            max-width: 400px;
            border-radius: var(--radius);
            padding: 15px;
            box-shadow: var(--shadow);
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .alert-success {
            background: var(--success);
            color: white;
            border-left: 4px solid #0da769;
        }
        
        .alert-error {
            background: var(--danger);
            color: white;
            border-left: 4px solid #d33;
        }
        
        .alert-warning {
            background: var(--warning);
            color: white;
            border-left: 4px solid #d97706;
        }
        
        .alert-info {
            background: var(--accent);
            color: white;
            border-left: 4px solid #5a4af4;
        }
        
        .alert-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .alert-content i:first-child {
            font-size: 20px;
        }
        
        .alert-content span {
            flex: 1;
            font-size: 14px;
        }
        
        .alert-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 0;
            font-size: 14px;
        }
        
        /* Dashboard Styles */
        .dashboard-section {
            padding: 100px 0;
            background-color: var(--primary);
            min-height: calc(100vh - 200px);
        }
        
        .dashboard-container {
            background-color: var(--secondary);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .dashboard-title {
            font-size: 1.8rem;
        }
        
        .dashboard-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            overflow-x: auto;
            padding-bottom: 5px;
        }
        
        .dashboard-tab {
            padding: 12px 20px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            transition: var(--transition);
            white-space: nowrap;
        }
        
        .dashboard-tab.active {
            color: var(--accent);
        }
        
        .dashboard-tab.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--accent);
        }
        
        .dashboard-content {
            display: none;
        }
        
        .dashboard-content.active {
            display: block;
        }
        
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--accent);
            margin: 10px 0;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--danger);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }
        
        .rides-history, .admin-rides, .admin-drivers, .admin-users {
            margin-top: 40px;
        }
        
        .rides-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .rides-table th,
        .rides-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .rides-table th {
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 14px;
        }
        
        .rides-table td {
            font-size: 14px;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .accept-btn {
            background-color: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        .accept-btn:hover {
            background-color: rgba(16, 185, 129, 0.3);
        }
        
        .decline-btn {
            background-color: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }
        
        .decline-btn:hover {
            background-color: rgba(239, 68, 68, 0.3);
        }
        
        .cancel-btn-admin {
            background-color: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .cancel-btn-admin:hover {
            background-color: rgba(245, 158, 11, 0.3);
        }
        
        .delete-btn {
            background-color: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }
        
        .delete-btn:hover {
            background-color: rgba(239, 68, 68, 0.3);
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-pending {
            background-color: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .status-confirmed {
            background-color: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        .status-completed {
            background-color: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }
        
        .status-cancelled {
            background-color: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }
        
        .status-declined {
            background-color: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }
        
        .empty-state i {
            font-size: 48px;
            margin-bottom: 20px;
            color: var(--accent);
        }
        
        /* Account Settings */
        .account-settings-form {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .form-note {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        .form-note i {
            color: var(--warning);
        }
        
        /* Profile Picture in Tables */
        .user-cell {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-table-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            overflow: hidden;
        }
        
        .user-table-avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .user-table-avatar-initials {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }
        
        /* Admin User Details */
        .user-details-modal {
            background-color: var(--secondary);
            border-radius: var(--radius);
            width: 90%;
            max-width: 800px;
            padding: 30px;
            box-shadow: var(--shadow);
            transform: translateY(30px);
            transition: var(--transition);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-overlay.active .user-details-modal {
            transform: translateY(0);
        }
        
        .user-details-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .user-details-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            overflow: hidden;
        }
        
        .user-details-avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .user-details-avatar-initials {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 600;
        }
        
        .user-details-info h3 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .user-details-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .user-detail-item {
            background-color: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: var(--radius);
        }
        
        .user-detail-label {
            color: var(--text-secondary);
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .user-detail-value {
            font-size: 14px;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .dashboard-section {
                padding: 80px 0;
            }
            
            .dashboard-container {
                padding: 20px;
            }
            
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 20px;
            }
            
            .rides-table {
                display: block;
                overflow-x: auto;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header & Navigation -->
    <header>
        <div class="container header-content">
            <div class="logo-container">
                <div class="logo">NR</div>
                <div class="logo-text">Nyt<span>Ryder</span></div>
            </div>
            
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
            
            <nav id="mainNav">
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#calculator">Book a Ride</a></li>
                    <li><a href="#services">Services</a></li>
                    <li><a href="#driver">Become a Driver</a></li>
                    <li id="dashboardLink" style="display: none;"><a href="#dashboard">Dashboard</a></li>
                </ul>
            </nav>
            
            <div class="user-actions" id="userActions">
                <button class="user-btn login-btn" id="loginBtn">Log In</button>
                <button class="user-btn register-btn" id="registerBtn">Sign Up</button>
                <button class="admin-header-btn" id="headerAdminBtn">
                    <i class="fas fa-user-shield"></i> Admin Login
                </button>
            </div>
            
            <div class="user-profile" id="userProfile" style="display: none;">
                <div class="user-avatar" id="userAvatar">
                    <div class="user-avatar-initials" id="userAvatarInitials">JD</div>
                    <img id="userAvatarImg" class="user-avatar-img" style="display: none;">
                </div>
                <div class="user-name" id="userName">John Doe</div>
                <i class="fas fa-chevron-down"></i>
                <div class="user-menu" id="userMenu">
                    <div class="user-menu-item" id="accountInfoBtn">
                        <i class="fas fa-user-circle"></i> Account Info
                    </div>
                    <div class="user-menu-item" id="ridesHistoryBtn">
                        <i class="fas fa-history"></i> Rides History
                    </div>
                    <div class="user-menu-item" id="pendingRidesBtn">
                        <i class="fas fa-clock"></i> Pending Rides
                    </div>
                    <div class="user-menu-item" id="accountSettingsBtn">
                        <i class="fas fa-cog"></i> Account Settings
                    </div>
                    <div class="user-menu-item admin-login-btn" id="adminLoginBtn" style="display: none;">
                        <i class="fas fa-user-shield"></i> Admin Login
                    </div>
                    <div class="user-menu-item" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Log Out
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Navigation -->
    <div class="mobile-nav" id="mobileNav">
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#calculator">Book a Ride</a></li>
            <li><a href="#services">Services</a></li>
            <li><a href="#driver">Become a Driver</a></li>
            <li id="mobileDashboardLink" style="display: none;"><a href="#dashboard">Dashboard</a></li>
        </ul>
        <div class="mobile-admin-login">
            <button class="mobile-admin-btn" id="mobileAdminBtn">
                <i class="fas fa-user-shield"></i> Admin Login
            </button>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal-overlay" id="authModal">
        <div class="auth-modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Welcome to Nyt Ryder</h2>
                <button class="close-modal" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" id="loginTab">Log In</button>
                <button class="auth-tab" id="registerTab">Register</button>
                <button class="auth-tab" id="driverTab">Become a Driver</button>
            </div>
            
            <!-- Login Form -->
            <div class="auth-form active" id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Email Address *</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email address" required>
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">Password *</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" required>
                </div>
                
                <button class="submit-btn" id="loginSubmitBtn">
                    <i class="fas fa-sign-in-alt"></i> Log In
                </button>
            </div>
            
            <!-- Register Form -->
            <div class="auth-form" id="registerForm">
                <div class="profile-picture-upload">
                    <div class="profile-preview" id="registerProfilePreview">
                        <img id="registerProfileImg" style="display: none;">
                        <div id="registerProfileInitials" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--accent), var(--accent-light)); color: white; font-weight: 600;">JD</div>
                    </div>
                    <div class="upload-controls">
                        <input type="file" id="registerProfileInput" accept="image/*" style="display: none;">
                        <button class="upload-btn" id="registerUploadBtn">
                            <i class="fas fa-upload"></i> Upload Photo
                        </button>
                        <div class="form-note">Max 2MB, JPG or PNG format</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="registerName">Full Name *</label>
                    <input type="text" id="registerName" placeholder="Enter your full name" required>
                </div>
                
                <div class="form-group">
                    <label for="registerPhone">Phone Number *</label>
                    <div class="phone-input-group">
                        <select class="phone-prefix" id="registerPrefix">
                            <option value="+27">+27 (ZA)</option>
                        </select>
                        <input type="tel" id="registerPhone" placeholder="Enter your phone number" maxlength="9" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="registerEmail">Email Address *</label>
                    <input type="email" id="registerEmail" placeholder="Enter your email address" required>
                </div>
                
                <div class="form-group">
                    <label for="registerPassword">Password *</label>
                    <input type="password" id="registerPassword" placeholder="Create a password (min. 6 characters)" required>
                </div>
                
                <div class="form-group">
                    <label for="registerAddress">Address (Optional)</label>
                    <input type="text" id="registerAddress" placeholder="Enter your address for faster booking">
                </div>
                
                <button class="submit-btn" id="registerSubmitBtn">
                    <i class="fas fa-user-plus"></i> Create Account
                </button>
            </div>
            
            <!-- Driver Registration Form -->
            <div class="auth-form" id="driverForm">
                <div class="driver-commission">
                    <h3><i class="fas fa-percentage"></i> Driver Commission</h3>
                    <p>Earn 65% of every ride you complete</p>
                    <div class="commission-rate">65%</div>
                    <p>We provide SpeedPoint machines and take only 35% commission</p>
                </div>
                
                <div class="profile-picture-upload">
                    <div class="profile-preview" id="driverProfilePreview">
                        <img id="driverProfileImg" style="display: none;">
                        <div id="driverProfileInitials" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--accent), var(--accent-light)); color: white; font-weight: 600;">JD</div>
                    </div>
                    <div class="upload-controls">
                        <input type="file" id="driverProfileInput" accept="image/*" style="display: none;">
                        <button class="upload-btn" id="driverUploadBtn">
                            <i class="fas fa-upload"></i> Upload Photo
                        </button>
                        <div class="form-note">Max 2MB, JPG or PNG format</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="driverName">Full Name *</label>
                    <input type="text" id="driverName" placeholder="Enter your full name" required>
                </div>
                
                <div class="form-group">
                    <label for="driverId">ID Number *</label>
                    <input type="text" id="driverId" placeholder="Enter your South African ID number" required>
                </div>
                
                <div class="form-group">
                    <label for="driverPhone">Phone Number *</label>
                    <div class="phone-input-group">
                        <select class="phone-prefix" id="driverPrefix">
                            <option value="+27">+27 (ZA)</option>
                        </select>
                        <input type="tel" id="driverPhone" placeholder="Enter your phone number" maxlength="9" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="driverEmail">Email Address *</label>
                    <input type="email" id="driverEmail" placeholder="Enter your email address" required>
                </div>
                
                <div class="form-group">
                    <label for="driverPassword">Password *</label>
                    <input type="password" id="driverPassword" placeholder="Create a password" required>
                </div>
                
                <div class="form-group">
                    <label for="driverAddress">Residential Address *</label>
                    <textarea id="driverAddress" placeholder="Enter your full residential address" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="driverLicense">Driver's License Number *</label>
                    <input type="text" id="driverLicense" placeholder="Enter your driver's license number" required>
                </div>
                
                <div class="form-group">
                    <label for="carModel">Car Model & Year *</label>
                    <input type="text" id="carModel" placeholder="e.g., Toyota Corolla 2020" required>
                </div>
                
                <div class="form-group">
                    <label for="carRegistration">Car Registration Number *</label>
                    <input type="text" id="carRegistration" placeholder="e.g., CA 123-456" required>
                </div>
                
                <div class="form-group">
                    <label for="carColor">Car Color *</label>
                    <input type="text" id="carColor" placeholder="e.g., Silver" required>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="criminalCheck"> I confirm I have no criminal record
                    </label>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="ownerCheck"> I confirm I am the owner of this vehicle
                    </label>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="termsCheck"> I agree to the 35% commission structure and terms of service
                    </label>
                </div>
                
                <button class="submit-btn" id="submitDriverBtn">Submit Driver Application</button>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div class="modal-overlay" id="adminModal">
        <div class="admin-modal">
            <div class="modal-header">
                <h2 class="modal-title">Admin Login</h2>
                <button class="close-modal" id="closeAdminModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="admin-note">
                <i class="fas fa-shield-alt"></i>
                <strong>Restricted Access:</strong> Admin area requires special access code
            </div>
            
            <div class="form-group">
                <label for="adminCode">Admin Access Code *</label>
                <input type="password" id="adminCode" placeholder="Enter admin access code" required>
                <div class="form-note">
                    <i class="fas fa-info-circle"></i> Contact system administrator for access code
                </div>
            </div>
            
            <button class="submit-btn" id="adminLoginSubmitBtn">
                <i class="fas fa-user-shield"></i> Login as Admin
            </button>
        </div>
    </div>

    <!-- User Details Modal -->
    <div class="modal-overlay" id="userDetailsModal">
        <div class="user-details-modal">
            <div class="modal-header">
                <h2 class="modal-title">User Details</h2>
                <button class="close-modal" id="closeUserDetailsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="userDetailsContent">
                <!-- Content will be loaded dynamically -->
            </div>
        </div>
    </div>

    <!-- Contact Information Modal -->
    <div class="modal-overlay" id="contactModal">
        <div class="contact-modal">
            <div class="modal-header">
                <h2 class="modal-title">Ride Confirmed!</h2>
                <button class="close-modal" id="closeContactModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="contactInfoContent">
                <div class="booking-success" id="bookingSuccess">
                    <div class="success-icon">
                        <i class="fas fa-check"></i>
                    </div>
                    <h2>Ride Successful!</h2>
                    <p>Your ride has been booked successfully. We will contact you via phone or WhatsApp to confirm your ride details.</p>
                    
                    <div class="contact-info-grid">
                        <div class="contact-card">
                            <h3><i class="fas fa-phone"></i> Contact Information</h3>
                            <p><strong>Phone:</strong> +27 43 642 1087</p>
                            <p><strong>WhatsApp:</strong> +27 82 123 4567</p>
                            <p><strong>Email:</strong> info@nytryder.co.za</p>
                            <p><strong>Operating Hours:</strong> 6 PM - 6 AM Daily</p>
                        </div>
                        
                        <div class="contact-card">
                            <h3><i class="fas fa-map-marker-alt"></i> Dispatch Information</h3>
                            <p>Your driver will contact you within 10-15 minutes to confirm pickup details.</p>
                            <p>Please have your payment method ready.</p>
                            <p>If you need to modify your ride, please call us immediately.</p>
                        </div>
                    </div>
                    
                    <button class="submit-btn" id="closeSuccessBtn" style="margin-top: 30px;">
                        <i class="fas fa-check-circle"></i> Got It, Thanks!
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Section (Hidden by default) -->
    <section class="dashboard-section" id="dashboard" style="display: none;">
        <div class="container">
            <div class="dashboard-container">
                <div class="dashboard-header">
                    <h2 class="dashboard-title">Dashboard</h2>
                    <div>
                        <span id="adminBadge" style="display: none; background: var(--warning); color: white; padding: 5px 10px; border-radius: 20px; font-size: 12px; font-weight: 600; margin-right: 10px;">
                            <i class="fas fa-user-shield"></i> Admin
                        </span>
                        <button class="user-btn register-btn" id="newRideBtn">Book New Ride</button>
                    </div>
                </div>
                
                <div class="dashboard-tabs">
                    <button class="dashboard-tab active" id="ridesTab">
                        <i class="fas fa-car"></i> My Rides
                    </button>
                    <button class="dashboard-tab" id="pendingRidesTab">
                        <i class="fas fa-clock"></i> Pending Rides
                        <span class="notification-badge" id="pendingRidesBadge" style="display: none;">0</span>
                    </button>
                    <button class="dashboard-tab" id="accountSettingsTab">
                        <i class="fas fa-cog"></i> Account Settings
                    </button>
                    <button class="dashboard-tab" id="adminRidesTab" style="display: none;">
                        <i class="fas fa-tasks"></i> Manage Rides
                        <span class="notification-badge" id="newRidesBadge" style="display: none;">0</span>
                    </button>
                    <button class="dashboard-tab" id="adminDriversTab" style="display: none;">
                        <i class="fas fa-users"></i> Driver Applications
                        <span class="notification-badge" id="newDriversBadge" style="display: none;">0</span>
                    </button>
                    <button class="dashboard-tab" id="adminUsersTab" style="display: none;">
                        <i class="fas fa-user-friends"></i> All Users
                    </button>
                </div>
                
                <!-- My Rides Content -->
                <div class="dashboard-content active" id="ridesContent">
                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <div class="stat-number" id="totalRides">0</div>
                            <div class="stat-label">Total Rides</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="activeRides">0</div>
                            <div class="stat-label">Active Rides</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="lastRide">-</div>
                            <div class="stat-label">Last Ride</div>
                        </div>
                    </div>
                    
                    <div class="rides-history">
                        <h3>Recent Rides</h3>
                        <div id="ridesHistory">
                            <div class="empty-state">
                                <i class="fas fa-car"></i>
                                <h4>No rides yet</h4>
                                <p>Book your first ride to see your history here</p>
                                <button class="cta-button" id="bookFirstRide">Book Your First Ride</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Pending Rides Content -->
                <div class="dashboard-content" id="pendingRidesContent">
                    <div class="admin-rides">
                        <h3>Your Pending Rides</h3>
                        <div id="pendingRidesList">
                            <div class="empty-state">
                                <i class="fas fa-clock"></i>
                                <h4>No pending rides</h4>
                                <p>All your rides are confirmed or completed</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Account Settings Content -->
                <div class="dashboard-content" id="accountSettingsContent">
                    <div class="account-settings-form">
                        <h3>Account Settings</h3>
                        
                        <div class="profile-picture-upload">
                            <div class="profile-preview" id="settingsProfilePreview">
                                <img id="settingsProfileImg" style="display: none;">
                                <div id="settingsProfileInitials" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--accent), var(--accent-light)); color: white; font-weight: 600;">JD</div>
                            </div>
                            <div class="upload-controls">
                                <input type="file" id="settingsProfileInput" accept="image/*" style="display: none;">
                                <button class="upload-btn" id="settingsUploadBtn">
                                    <i class="fas fa-upload"></i> Change Photo
                                </button>
                                <div class="form-note">Max 2MB, JPG or PNG format</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="settingsName">Full Name</label>
                            <input type="text" id="settingsName" placeholder="Your full name" readonly>
                            <div class="form-note"><i class="fas fa-info-circle"></i> Name cannot be changed for security reasons</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="settingsEmail">Email Address</label>
                            <input type="email" id="settingsEmail" placeholder="Your email address">
                        </div>
                        
                        <div class="form-group">
                            <label for="settingsPhone">Phone Number</label>
                            <div class="phone-input-group">
                                <select class="phone-prefix" id="settingsPrefix">
                                    <option value="+27">+27 (ZA)</option>
                                </select>
                                <input type="tel" id="settingsPhone" placeholder="Your phone number" maxlength="9">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="settingsAddress">Address</label>
                            <input type="text" id="settingsAddress" placeholder="Your address">
                        </div>
                        
                        <div class="form-group">
                            <label for="currentPassword">Current Password</label>
                            <input type="password" id="currentPassword" placeholder="Enter current password">
                        </div>
                        
                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <input type="password" id="newPassword" placeholder="Enter new password">
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmPassword">Confirm New Password</label>
                            <input type="password" id="confirmPassword" placeholder="Confirm new password">
                        </div>
                        
                        <button class="submit-btn" id="saveSettingsBtn">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </div>
                
                <!-- Admin Rides Content -->
                <div class="dashboard-content" id="adminRidesContent">
                    <div class="admin-rides">
                        <h3>Manage All Rides</h3>
                        <div id="adminRidesList">
                            <div class="empty-state">
                                <i class="fas fa-car"></i>
                                <h4>No rides to manage</h4>
                                <p>When users book rides, they will appear here</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Admin Drivers Content -->
                <div class="dashboard-content" id="adminDriversContent">
                    <div class="admin-drivers">
                        <h3>Driver Applications</h3>
                        <div id="adminDriversList">
                            <div class="empty-state">
                                <i class="fas fa-users"></i>
                                <h4>No driver applications</h4>
                                <p>When drivers apply, their applications will appear here</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Admin Users Content -->
                <div class="dashboard-content" id="adminUsersContent">
                    <div class="admin-users">
                        <h3>All Registered Users</h3>
                        <div id="adminUsersList">
                            <div class="empty-state">
                                <i class="fas fa-user-friends"></i>
                                <h4>No users registered</h4>
                                <p>User data will appear here</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="container">
            <h1>After Hours <span class="accent-text">E-Hailing</span> Across Eastern Cape</h1>
            <p>Safe, reliable rides when you need them most. Nyt Ryder operates exclusively from 6 PM to 6 AM, providing premium transportation services throughout the night with competitive pricing.</p>
            <div class="location-tag">
                <i class="fas fa-map-marker-alt"></i> Serving all towns and villages across Eastern Cape
            </div>
            
            <div class="cta-buttons">
                <a href="#calculator" class="cta-button">Book a Ride</a>
                <a href="#driver" class="cta-button secondary">Become a Driver</a>
            </div>
        </div>
    </section>

    <!-- Pricing Calculator -->
    <section class="calculator-section" id="calculator">
        <div class="container">
            <h2 class="section-title">Book Your Ride</h2>
            
            <div class="calculator-container">
                <div class="calculator-notice" id="calculatorNotice">
                    <i class="fas fa-info-circle"></i> You need to <a href="#" id="noticeLoginLink">log in</a> or <a href="#" id="noticeRegisterLink">register</a> to book a ride. This helps us save your ride history for future reference.
                </div>
                
                <div class="form-group">
                    <label for="pickupTime">Pickup Time</label>
                    <select id="pickupTime">
                        <option value="">Select pickup time</option>
                        <option value="18:00">6:00 PM</option>
                        <option value="18:30">6:30 PM</option>
                        <option value="19:00">7:00 PM</option>
                        <option value="19:30">7:30 PM</option>
                        <option value="20:00">8:00 PM</option>
                        <option value="20:30">8:30 PM</option>
                        <option value="21:00">9:00 PM</option>
                        <option value="21:30">9:30 PM</option>
                        <option value="22:00">10:00 PM</option>
                        <option value="22:30">10:30 PM</option>
                        <option value="23:00">11:00 PM</option>
                        <option value="23:30">11:30 PM</option>
                        <option value="00:00">12:00 AM</option>
                        <option value="00:30">12:30 AM</option>
                        <option value="01:00">1:00 AM</option>
                        <option value="01:30">1:30 AM</option>
                        <option value="02:00">2:00 AM</option>
                        <option value="02:30">2:30 AM</option>
                        <option value="03:00">3:00 AM</option>
                        <option value="03:30">3:30 AM</option>
                        <option value="04:00">4:00 AM</option>
                        <option value="04:30">4:30 AM</option>
                        <option value="05:00">5:00 AM</option>
                        <option value="05:30">5:30 AM</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="pickupSearch">Pickup Location</label>
                    <div class="location-search-container">
                        <i class="fas fa-search location-search-icon"></i>
                        <input type="text" id="pickupSearch" class="location-search-input" placeholder="Type to search locations...">
                        <div class="location-results" id="pickupResults"></div>
                    </div>
                    <input type="hidden" id="pickupValue">
                </div>
                
                <div class="form-group">
                    <label for="destinationSearch">Destination</label>
                    <div class="location-search-container">
                        <i class="fas fa-search location-search-icon"></i>
                        <input type="text" id="destinationSearch" class="location-search-input" placeholder="Type to search locations...">
                        <div class="location-results" id="destinationResults"></div>
                    </div>
                    <input type="hidden" id="destinationValue">
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="returnTripCheck"> This is a return trip
                    </label>
                </div>
                
                <div class="return-trip-options" id="returnTripOptions">
                    <h4><i class="fas fa-history"></i> Waiting Period</h4>
                    <p>Select how long you need the driver to wait for your return trip:</p>
                    
                    <div class="waiting-options">
                        <div class="waiting-option" data-minutes="30">
                            <div class="waiting-time">30 minutes</div>
                            <div class="waiting-price">Waiting fee applies</div>
                        </div>
                        <div class="waiting-option" data-minutes="60">
                            <div class="waiting-time">1 hour</div>
                            <div class="waiting-price">Waiting fee applies</div>
                        </div>
                        <div class="waiting-option" data-minutes="90">
                            <div class="waiting-time">1.5 hours</div>
                            <div class="waiting-price">Waiting fee applies</div>
                        </div>
                        <div class="waiting-option" data-minutes="120">
                            <div class="waiting-time">2 hours</div>
                            <div class="waiting-price">Waiting fee applies</div>
                        </div>
                    </div>
                    <input type="hidden" id="waitingPeriod">
                </div>
                
                <div class="form-group">
                    <label for="driverInstructions">Special Instructions for Driver (Optional)</label>
                    <textarea id="driverInstructions" placeholder="E.g., Call when arriving, specific pickup point, etc." rows="3"></textarea>
                </div>
                
                <div class="payment-methods" id="paymentMethods">
                    <h4><i class="fas fa-credit-card"></i> Select Payment Method</h4>
                    
                    <div class="payment-option" data-method="speedpoint">
                        <div class="payment-icon">
                            <i class="fas fa-credit-card"></i>
                        </div>
                        <div class="payment-details-text">
                            <h4>SpeedPoint with Driver</h4>
                            <p>Pay with card when driver arrives</p>
                        </div>
                    </div>
                    
                    <div class="payment-option" data-method="cash">
                        <div class="payment-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="payment-details-text">
                            <h4>Cash Payment</h4>
                            <p>Pay with cash to the driver</p>
                        </div>
                    </div>
                    
                    <div class="payment-option" data-method="eft">
                        <div class="payment-icon">
                            <i class="fas fa-university"></i>
                        </div>
                        <div class="payment-details-text">
                            <h4>Bank Transfer (EFT)</h4>
                            <p>Pay via EFT before the ride</p>
                        </div>
                    </div>
                </div>
                <input type="hidden" id="selectedPaymentMethod">
                
                <button class="calculate-btn" id="calculateBtn" disabled>
                    <i class="fas fa-car"></i> Get Fare Estimate
                </button>
                
                <div class="result-container" id="resultContainer">
                    <div class="result-header">
                        <div class="result-title">Estimated Fare</div>
                        <div class="result-price" id="resultPrice">R0.00</div>
                    </div>
                    
                    <p>Your estimated fare based on the distance. Final price may vary based on exact route and traffic conditions.</p>
                    
                    <div class="result-details">
                        <div class="detail-box">
                            <h4>Pickup</h4>
                            <p id="resultFrom">Location</p>
                        </div>
                        <div class="detail-box">
                            <h4>Destination</h4>
                            <p id="resultTo">Location</p>
                        </div>
                        <div class="detail-box">
                            <h4>Pickup Time</h4>
                            <p id="resultTime">Time</p>
                        </div>
                        <div class="detail-box">
                            <h4>Estimated Distance</h4>
                            <p id="resultDistance">0 km</p>
                        </div>
                    </div>
                    
                    <div class="booking-confirmation" id="bookingConfirmation">
                        <h3><i class="fas fa-question-circle"></i> Would you like to book this ride?</h3>
                        <p>If you'd like to proceed with booking this ride, click "Book Now". We'll provide you with our contact information and payment options.</p>
                        
                        <div class="confirmation-buttons">
                            <button class="confirm-btn book-now-btn" id="bookNowBtn">
                                <i class="fas fa-car"></i> Book Now
                            </button>
                            <button class="confirm-btn cancel-btn" id="cancelBookingBtn">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Driver Registration Section -->
    <section class="calculator-section" id="driver">
        <div class="container">
            <h2 class="section-title">Become a Nyt Ryder Driver</h2>
            
            <div class="calculator-container">
                <div class="driver-commission">
                    <h3><i class="fas fa-percentage"></i> Driver Commission</h3>
                    <p>Earn 65% of every ride you complete</p>
                    <div class="commission-rate">65%</div>
                    <p>We provide SpeedPoint machines and handle all booking administration</p>
                </div>
                
                <div class="calculator-notice">
                    <h3><i class="fas fa-check-circle"></i> Driver Requirements:</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Valid South African driver's license</li>
                        <li>Vehicle ownership proof (in your name)</li>
                        <li>Clean criminal record</li>
                        <li>Valid vehicle license disc & roadworthy certificate</li>
                        <li>Comprehensive insurance (recommended)</li>
                        <li>Available to work night shifts (6 PM - 6 AM)</li>
                    </ul>
                </div>
                
                <div class="calculator-notice" style="background-color: rgba(16, 185, 129, 0.1); border-color: var(--success);">
                    <h3><i class="fas fa-shield-alt"></i> We Provide:</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>SpeedPoint payment machines</li>
                        <li>24/7 dispatch support</li>
                        <li>Customer ride management</li>
                        <li>Marketing and customer acquisition</li>
                        <li>Driver safety protocols</li>
                        <li>Weekly payment processing</li>
                    </ul>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="cta-button secondary" id="openDriverForm">
                        <i class="fas fa-user-plus"></i> Apply to Become a Driver
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section class="services-section" id="services">
        <div class="container">
            <h2 class="section-title">Our Services</h2>
            
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-car"></i>
                    </div>
                    <h3>Standard Rides</h3>
                    <p>Comfortable and reliable transportation for individuals and small groups across all Eastern Cape towns and villages.</p>
                </div>
                
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-user-friends"></i>
                    </div>
                    <h3>Group Rides</h3>
                    <p>Larger vehicles available for groups traveling together during night hours.</p>
                </div>
                
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <h3>Business Service</h3>
                    <p>Professional drivers for business travelers needing late-night transportation.</p>
                </div>
            </div>
        </div>
    </section>

    <footer id="contact">
        <div class="container">
            <div class="footer-content">
                <div class="footer-about">
                    <div class="footer-logo">Nyt<span>Ryder</span></div>
                    <p class="footer-description">Providing safe and reliable after-hours e-hailing services across Eastern Cape from 6 PM to 6 AM. We ensure you get to your destination safely, no matter the hour.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                
                <div class="footer-links-container">
                    <h3 class="footer-heading">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#home">Home</a></li>
                        <li><a href="#calculator">Book a Ride</a></li>
                        <li><a href="#services">Services</a></li>
                        <li><a href="#driver">Become a Driver</a></li>
                    </ul>
                </div>
                
                <div class="footer-contact">
                    <h3 class="footer-heading">Contact Us</h3>
                    <ul class="footer-links">
                        <li><i class="fas fa-phone"></i> +27 43 642 1087</li>
                        <li><i class="fas fa-envelope"></i> info@nytryder.co.za</li>
                        <li><i class="fas fa-map-marker-alt"></i> Eastern Cape, South Africa</li>
                    </ul>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2023 Nyt Ryder. All rights reserved. | After Hours E-Hailing Service</p>
            </div>
        </div>
    </footer>

    <script>
        // ===================== DATA STORAGE SYSTEM =====================
        class DataStorage {
            constructor() {
                this.usersKey = 'nytRyderUsers';
                this.ridesKey = 'nytRyderRides';
                this.currentUserKey = 'nytRyderCurrentUser';
                this.driversKey = 'nytRyderDrivers';
                this.notificationsKey = 'nytRyderNotifications';
                // Admin secret code
                this.ADMIN_SECRET_CODE = '548755';
            }
            
            // User Management
            saveUser(user) {
                const users = this.getUsers();
                const existingUserIndex = users.findIndex(u => u.email === user.email);
                
                if (existingUserIndex > -1) {
                    users[existingUserIndex] = { ...users[existingUserIndex], ...user };
                } else {
                    user.id = Date.now().toString();
                    user.createdAt = new Date().toISOString();
                    user.rides = [];
                    user.isDriver = user.isDriver || false;
                    user.isAdmin = user.isAdmin || false;
                    users.push(user);
                }
                
                localStorage.setItem(this.usersKey, JSON.stringify(users));
                return user;
            }
            
            getUsers() {
                return JSON.parse(localStorage.getItem(this.usersKey)) || [];
            }
            
            getUserById(id) {
                return this.getUsers().find(user => user.id === id);
            }
            
            getUserByEmail(email) {
                return this.getUsers().find(user => user.email.toLowerCase() === email.toLowerCase());
            }
            
            // Admin Functions
            verifyAdminCode(code) {
                return code === this.ADMIN_SECRET_CODE;
            }
            
            // Ride Management
            saveRide(ride) {
                const rides = this.getRides();
                ride.id = Date.now().toString();
                ride.createdAt = new Date().toISOString();
                ride.status = 'pending';
                ride.adminNotified = false;
                rides.push(ride);
                
                localStorage.setItem(this.ridesKey, JSON.stringify(rides));
                
                // Also add to user's rides
                const users = this.getUsers();
                const userIndex = users.findIndex(u => u.id === ride.userId);
                if (userIndex > -1) {
                    if (!users[userIndex].rides) users[userIndex].rides = [];
                    users[userIndex].rides.push(ride.id);
                    localStorage.setItem(this.usersKey, JSON.stringify(users));
                }
                
                // Add notification for admin
                this.addNotification({
                    type: 'new_ride',
                    message: `New ride booked by ${users[userIndex]?.name || 'Unknown User'}`,
                    rideId: ride.id,
                    read: false,
                    createdAt: new Date().toISOString()
                });
                
                return ride;
            }
            
            getRides() {
                return JSON.parse(localStorage.getItem(this.ridesKey)) || [];
            }
            
            getUserRides(userId) {
                return this.getRides().filter(ride => ride.userId === userId);
            }
            
            getPendingRides() {
                return this.getRides().filter(ride => ride.status === 'pending');
            }
            
            updateRideStatus(rideId, status) {
                const rides = this.getRides();
                const rideIndex = rides.findIndex(ride => ride.id === rideId);
                
                if (rideIndex > -1) {
                    rides[rideIndex].status = status;
                    rides[rideIndex].updatedAt = new Date().toISOString();
                    
                    // Add notification for user
                    const user = this.getUserById(rides[rideIndex].userId);
                    if (user) {
                        this.addNotification({
                            type: 'ride_update',
                            message: `Your ride has been ${status}`,
                            rideId: rideId,
                            userId: user.id,
                            read: false,
                            createdAt: new Date().toISOString()
                        });
                    }
                    
                    localStorage.setItem(this.ridesKey, JSON.stringify(rides));
                    return rides[rideIndex];
                }
                
                return null;
            }
            
            deleteRide(rideId) {
                const rides = this.getRides();
                const filteredRides = rides.filter(ride => ride.id !== rideId);
                localStorage.setItem(this.ridesKey, JSON.stringify(filteredRides));
                return true;
            }
            
            // Driver Applications
            saveDriverApplication(driver) {
                const drivers = this.getDriverApplications();
                driver.id = Date.now().toString();
                driver.createdAt = new Date().toISOString();
                driver.status = 'pending';
                drivers.push(driver);
                
                localStorage.setItem(this.driversKey, JSON.stringify(drivers));
                
                // Add notification for admin
                this.addNotification({
                    type: 'new_driver',
                    message: `New driver application from ${driver.name}`,
                    driverId: driver.id,
                    read: false,
                    createdAt: new Date().toISOString()
                });
                
                return driver;
            }
            
            getDriverApplications() {
                return JSON.parse(localStorage.getItem(this.driversKey)) || [];
            }
            
            getPendingDriverApplications() {
                return this.getDriverApplications().filter(driver => driver.status === 'pending');
            }
            
            updateDriverApplicationStatus(driverId, status) {
                const drivers = this.getDriverApplications();
                const driverIndex = drivers.findIndex(driver => driver.id === driverId);
                
                if (driverIndex > -1) {
                    drivers[driverIndex].status = status;
                    drivers[driverIndex].updatedAt = new Date().toISOString();
                    localStorage.setItem(this.driversKey, JSON.stringify(drivers));
                    
                    // If accepted, also update user role
                    if (status === 'accepted') {
                        const user = this.getUserById(drivers[driverIndex].userId);
                        if (user) {
                            user.isDriver = true;
                            this.saveUser(user);
                        }
                    }
                    
                    return drivers[driverIndex];
                }
                
                return null;
            }
            
            deleteDriverApplication(driverId) {
                const drivers = this.getDriverApplications();
                const filteredDrivers = drivers.filter(driver => driver.id !== driverId);
                localStorage.setItem(this.driversKey, JSON.stringify(filteredDrivers));
                return true;
            }
            
            // Notifications
            addNotification(notification) {
                const notifications = this.getNotifications();
                notification.id = Date.now().toString();
                notifications.push(notification);
                localStorage.setItem(this.notificationsKey, JSON.stringify(notifications));
                return notification;
            }
            
            getNotifications() {
                return JSON.parse(localStorage.getItem(this.notificationsKey)) || [];
            }
            
            getUnreadNotificationsCount() {
                const notifications = this.getNotifications();
                return notifications.filter(n => !n.read).length;
            }
            
            markNotificationAsRead(notificationId) {
                const notifications = this.getNotifications();
                const notificationIndex = notifications.findIndex(n => n.id === notificationId);
                
                if (notificationIndex > -1) {
                    notifications[notificationIndex].read = true;
                    localStorage.setItem(this.notificationsKey, JSON.stringify(notifications));
                }
            }
            
            markAllNotificationsAsRead() {
                const notifications = this.getNotifications();
                notifications.forEach(n => n.read = true);
                localStorage.setItem(this.notificationsKey, JSON.stringify(notifications));
            }
            
            // Current User
            setCurrentUser(user) {
                localStorage.setItem(this.currentUserKey, JSON.stringify(user));
            }
            
            getCurrentUser() {
                return JSON.parse(localStorage.getItem(this.currentUserKey));
            }
            
            clearCurrentUser() {
                localStorage.removeItem(this.currentUserKey);
            }
            
            // Admin
            getAdminStats() {
                const rides = this.getRides();
                const drivers = this.getDriverApplications();
                const users = this.getUsers();
                
                return {
                    totalRides: rides.length,
                    pendingRides: rides.filter(r => r.status === 'pending').length,
                    totalUsers: users.length,
                    totalDrivers: drivers.filter(d => d.status === 'accepted').length,
                    pendingDrivers: drivers.filter(d => d.status === 'pending').length
                };
            }
        }

        // ===================== APPLICATION STATE =====================
        const storage = new DataStorage();
        let currentUser = storage.getCurrentUser();
        let currentRide = null;
        
        // Expanded Eastern Cape locations including villages
        const easternCapeLocations = [
            "East London", "Port Elizabeth (Gqeberha)", "Mthatha", "Bhisho", "Queenstown",
            "Graaff-Reinet", "Cradock", "Grahamstown (Makhanda)", "Jeffreys Bay", 
            "Stutterheim", "Aliwal North", "Butterworth", "Kokstad", "Sterkspruit",
            "Qonce CBD", "Zwelitsha", "Mdantsane", "Cambridge", "Braelyn", "Amalinda",
            "Uitenhage", "Despatch", "Motherwell", "Walmer", "Summerstrand",
            "New Brighton", "Zwide", "Korsten", "Gelvandale", "Bethelsdorp",
            // More villages and towns
            "Adelaide", "Alicedale", "Barkly East", "Bedford", "Cala", "Cathcart",
            "Cookhouse", "Dordrecht", "Elliot", "Fort Beaufort", "Hankey", "Hofmeyr",
            "Humansdorp", "Idutywa", "Jansenville", "Kei Mouth", "Keiskammahoek",
            "Kirkwood", "Lady Frere", "Libode", "Lusikisiki", "Maclear", "Middelburg EC",
            "Molteno", "Mount Fletcher", "Mount Frere", "Mqanduli", "Ngcobo", "Nqamakwe",
            "Patensie", "Peddie", "Port Alfred", "Port St Johns", "Riebeeck East",
            "Somerset East", "St Francis Bay", "Steytlerville", "Tarkastad", "Willowmore",
            "Whitney", "Wodehouse", "Aberdeen", "Alexandria", "Baviaanskloof", "Bluewater Bay",
            "Colchester", "Coffee Bay", "Dimbaza", "Gonubie", "Hamburg", "Haga Haga",
            "Hertzog", "Hole in the Wall", "Ilinge", "Kareedouw", "Kenton-on-Sea", "Komga",
            "Kwandwe", "Loerie", "Mbokotwana", "Middledrift", "Morgan's Bay", "Nahoon",
            "Ncambedlana", "Newlands", "Nompumelelo", "Orange Grove", "Paterson",
            "Port Grosvenor", "Red Location", "Sam's, Ndabakazi", "Sandile", "Seymour",
            "Stoneybrook", "Tolokiwa", "Tsomo", "Tyutyu", "Umtata", "Veeplaas", "Waterloo",
            "Wartburg", "Xhora", "Zweledinga"
        ];
        
        // ===================== UTILITY FUNCTIONS =====================
        function showAlert(message, type = 'info') {
            const existingAlert = document.querySelector('.custom-alert');
            if (existingAlert) existingAlert.remove();
            
            const alert = document.createElement('div');
            alert.className = `custom-alert alert-${type}`;
            alert.innerHTML = `
                <div class="alert-content">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                    <span>${message}</span>
                    <button class="alert-close"><i class="fas fa-times"></i></button>
                </div>
            `;
            
            document.body.appendChild(alert);
            
            alert.querySelector('.alert-close').addEventListener('click', function() {
                alert.remove();
            });
            
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.remove();
                }
            }, 5000);
        }
        
        function getInitials(name) {
            if (!name) return 'NR';
            return name.split(' ').map(part => part[0]).join('').toUpperCase().substring(0, 2);
        }
        
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
        
        function formatCurrency(amount) {
            return 'R' + parseFloat(amount).toFixed(2);
        }
        
        function dataURLtoBlob(dataurl) {
            const arr = dataurl.split(',');
            const mime = arr[0].match(/:(.*?);/)[1];
            const bstr = atob(arr[1]);
            let n = bstr.length;
            const u8arr = new Uint8Array(n);
            while (n--) {
                u8arr[n] = bstr.charCodeAt(n);
            }
            return new Blob([u8arr], { type: mime });
        }
        
        function compressImage(file, maxWidth = 400, maxHeight = 400, quality = 0.8) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = (event) => {
                    const img = new Image();
                    img.src = event.target.result;
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        let width = img.width;
                        let height = img.height;
                        
                        if (width > height) {
                            if (width > maxWidth) {
                                height *= maxWidth / width;
                                width = maxWidth;
                            }
                        } else {
                            if (height > maxHeight) {
                                width *= maxHeight / height;
                                height = maxHeight;
                            }
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        canvas.toBlob((blob) => {
                            resolve(blob);
                        }, 'image/jpeg', quality);
                    };
                    img.onerror = reject;
                };
                reader.onerror = reject;
            });
        }
        
        // ===================== AUTH FUNCTIONS =====================
        function openAuthModal(tab) {
            const authModal = document.getElementById('authModal');
            if (authModal) {
                authModal.classList.add('active');
                document.body.style.overflow = 'hidden';
                switchAuthTab(tab);
            }
        }
        
        function closeAuthModal() {
            const authModal = document.getElementById('authModal');
            if (authModal) {
                authModal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }
        
        function openAdminModal() {
            const adminModal = document.getElementById('adminModal');
            if (adminModal) {
                adminModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeAdminModal() {
            const adminModal = document.getElementById('adminModal');
            if (adminModal) {
                adminModal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }
        
        function openUserDetailsModal(userId) {
            const modal = document.getElementById('userDetailsModal');
            if (modal) {
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                loadUserDetails(userId);
            }
        }
        
        function closeUserDetailsModal() {
            const modal = document.getElementById('userDetailsModal');
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }
        
        function switchAuthTab(tab) {
            const forms = ['loginForm', 'registerForm', 'driverForm'];
            forms.forEach(formId => {
                const form = document.getElementById(formId);
                if (form) form.classList.remove('active');
            });
            
            const tabs = ['loginTab', 'registerTab', 'driverTab'];
            tabs.forEach(tabId => {
                const tab = document.getElementById(tabId);
                if (tab) tab.classList.remove('active');
            });
            
            if (tab === 'login') {
                const loginTab = document.getElementById('loginTab');
                const loginForm = document.getElementById('loginForm');
                if (loginTab) loginTab.classList.add('active');
                if (loginForm) loginForm.classList.add('active');
            } else if (tab === 'register') {
                const registerTab = document.getElementById('registerTab');
                const registerForm = document.getElementById('registerForm');
                if (registerTab) registerTab.classList.add('active');
                if (registerForm) registerForm.classList.add('active');
            } else if (tab === 'driver') {
                const driverTab = document.getElementById('driverTab');
                const driverForm = document.getElementById('driverForm');
                if (driverTab) driverTab.classList.add('active');
                if (driverForm) driverForm.classList.add('active');
            }
        }
        
        function loginUser(user) {
            storage.setCurrentUser(user);
            currentUser = user;
            updateUI();
            closeAuthModal();
            showAlert(`Welcome back, ${user.name}!`, 'success');
        }
        
        function logoutUser() {
            if (confirm('Are you sure you want to log out?')) {
                storage.clearCurrentUser();
                currentUser = null;
                updateUI();
                showAlert('Logged out successfully', 'success');
            }
        }
        
        function adminLogin() {
            const code = document.getElementById('adminCode').value;
            
            if (!code) {
                showAlert('Please enter admin access code', 'error');
                return;
            }
            
            if (storage.verifyAdminCode(code)) {
                // Create admin user if not exists
                const adminUser = {
                    name: 'Administrator',
                    email: 'admin@nytryder.co.za',
                    isAdmin: true,
                    isDriver: false
                };
                
                storage.saveUser(adminUser);
                storage.setCurrentUser(adminUser);
                currentUser = adminUser;
                
                closeAdminModal();
                updateUI();
                showAlert('Admin login successful!', 'success');
                
                // Show dashboard
                showDashboard('adminRides');
            } else {
                showAlert('Invalid admin access code', 'error');
            }
        }
        
        // ===================== UI FUNCTIONS =====================
        function updateUI() {
            const userProfile = document.getElementById('userProfile');
            const userActions = document.getElementById('userActions');
            const dashboardLink = document.getElementById('dashboardLink');
            const mobileDashboardLink = document.getElementById('mobileDashboardLink');
            const calculateBtn = document.getElementById('calculateBtn');
            const calculatorNotice = document.getElementById('calculatorNotice');
            const adminRidesTab = document.getElementById('adminRidesTab');
            const adminDriversTab = document.getElementById('adminDriversTab');
            const adminUsersTab = document.getElementById('adminUsersTab');
            const adminBadge = document.getElementById('adminBadge');
            const adminLoginBtn = document.getElementById('adminLoginBtn');
            const headerAdminBtn = document.getElementById('headerAdminBtn');
            
            if (currentUser) {
                // User is logged in
                if (userProfile) {
                    userProfile.style.display = 'flex';
                    updateUserAvatar();
                    document.getElementById('userName').textContent = currentUser.name;
                }
                
                if (userActions) userActions.style.display = 'none';
                if (dashboardLink) dashboardLink.style.display = 'block';
                if (mobileDashboardLink) mobileDashboardLink.style.display = 'block';
                if (calculateBtn) calculateBtn.disabled = false;
                if (calculatorNotice) calculatorNotice.style.display = 'none';
                
                // Show admin tabs if user is admin
                if (currentUser.isAdmin) {
                    if (adminRidesTab) adminRidesTab.style.display = 'block';
                    if (adminDriversTab) adminDriversTab.style.display = 'block';
                    if (adminUsersTab) adminUsersTab.style.display = 'block';
                    if (adminBadge) adminBadge.style.display = 'inline-block';
                    if (adminLoginBtn) adminLoginBtn.style.display = 'block';
                    if (headerAdminBtn) headerAdminBtn.style.display = 'none';
                } else {
                    if (adminRidesTab) adminRidesTab.style.display = 'none';
                    if (adminDriversTab) adminDriversTab.style.display = 'none';
                    if (adminUsersTab) adminUsersTab.style.display = 'none';
                    if (adminBadge) adminBadge.style.display = 'none';
                    if (adminLoginBtn) adminLoginBtn.style.display = 'none';
                    if (headerAdminBtn) headerAdminBtn.style.display = 'inline-block';
                }
                
                // Update notification badges
                updateNotificationBadges();
                
            } else {
                // User is not logged in
                if (userProfile) userProfile.style.display = 'none';
                if (userActions) userActions.style.display = 'flex';
                if (dashboardLink) dashboardLink.style.display = 'none';
                if (mobileDashboardLink) mobileDashboardLink.style.display = 'none';
                if (calculateBtn) calculateBtn.disabled = true;
                if (calculatorNotice) calculatorNotice.style.display = 'block';
                if (adminRidesTab) adminRidesTab.style.display = 'none';
                if (adminDriversTab) adminDriversTab.style.display = 'none';
                if (adminUsersTab) adminUsersTab.style.display = 'none';
                if (adminBadge) adminBadge.style.display = 'none';
                if (adminLoginBtn) adminLoginBtn.style.display = 'none';
                if (headerAdminBtn) headerAdminBtn.style.display = 'inline-block';
                
                // Hide dashboard
                document.getElementById('dashboard').style.display = 'none';
            }
        }
        
        function updateUserAvatar() {
            if (!currentUser) return;
            
            const avatarImg = document.getElementById('userAvatarImg');
            const avatarInitials = document.getElementById('userAvatarInitials');
            
            if (currentUser.profilePicture) {
                avatarImg.src = currentUser.profilePicture;
                avatarImg.style.display = 'block';
                avatarInitials.style.display = 'none';
            } else {
                avatarImg.style.display = 'none';
                avatarInitials.style.display = 'flex';
                avatarInitials.textContent = getInitials(currentUser.name);
            }
        }
        
        function updateNotificationBadges() {
            if (!currentUser) return;
            
            const pendingRides = storage.getPendingRides();
            const pendingDrivers = storage.getPendingDriverApplications();
            const userPendingRides = pendingRides.filter(ride => ride.userId === currentUser.id);
            
            // Update user pending rides badge
            const pendingRidesBadge = document.getElementById('pendingRidesBadge');
            if (pendingRidesBadge) {
                if (userPendingRides.length > 0) {
                    pendingRidesBadge.textContent = userPendingRides.length;
                    pendingRidesBadge.style.display = 'inline-block';
                } else {
                    pendingRidesBadge.style.display = 'none';
                }
            }
            
            // Update admin badges
            if (currentUser.isAdmin) {
                const newRidesBadge = document.getElementById('newRidesBadge');
                const newDriversBadge = document.getElementById('newDriversBadge');
                
                if (newRidesBadge) {
                    if (pendingRides.length > 0) {
                        newRidesBadge.textContent = pendingRides.length;
                        newRidesBadge.style.display = 'inline-block';
                    } else {
                        newRidesBadge.style.display = 'none';
                    }
                }
                
                if (newDriversBadge) {
                    if (pendingDrivers.length > 0) {
                        newDriversBadge.textContent = pendingDrivers.length;
                        newDriversBadge.style.display = 'inline-block';
                    } else {
                        newDriversBadge.style.display = 'none';
                    }
                }
            }
        }
        
        function showDashboard(tab = 'rides') {
            if (!currentUser) {
                showAlert('Please log in to view dashboard', 'error');
                openAuthModal('login');
                return;
            }
            
            // Hide all sections
            document.querySelectorAll('section').forEach(section => {
                if (section.id !== 'dashboard') {
                    section.style.display = 'none';
                }
            });
            
            // Show dashboard
            const dashboard = document.getElementById('dashboard');
            dashboard.style.display = 'block';
            
            // Switch to requested tab
            switchDashboardTab(tab);
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function switchDashboardTab(tab) {
            const contents = ['ridesContent', 'pendingRidesContent', 'accountSettingsContent', 'adminRidesContent', 'adminDriversContent', 'adminUsersContent'];
            contents.forEach(contentId => {
                const content = document.getElementById(contentId);
                if (content) content.classList.remove('active');
            });
            
            const tabs = ['ridesTab', 'pendingRidesTab', 'accountSettingsTab', 'adminRidesTab', 'adminDriversTab', 'adminUsersTab'];
            tabs.forEach(tabId => {
                const tab = document.getElementById(tabId);
                if (tab) tab.classList.remove('active');
            });
            
            if (tab === 'rides') {
                const ridesTab = document.getElementById('ridesTab');
                const ridesContent = document.getElementById('ridesContent');
                if (ridesTab) ridesTab.classList.add('active');
                if (ridesContent) ridesContent.classList.add('active');
                updateRidesContent();
            } else if (tab === 'pending') {
                const pendingRidesTab = document.getElementById('pendingRidesTab');
                const pendingRidesContent = document.getElementById('pendingRidesContent');
                if (pendingRidesTab) pendingRidesTab.classList.add('active');
                if (pendingRidesContent) pendingRidesContent.classList.add('active');
                updatePendingRidesContent();
            } else if (tab === 'settings') {
                const accountSettingsTab = document.getElementById('accountSettingsTab');
                const accountSettingsContent = document.getElementById('accountSettingsContent');
                if (accountSettingsTab) accountSettingsTab.classList.add('active');
                if (accountSettingsContent) accountSettingsContent.classList.add('active');
                loadAccountSettings();
            } else if (tab === 'adminRides') {
                const adminRidesTab = document.getElementById('adminRidesTab');
                const adminRidesContent = document.getElementById('adminRidesContent');
                if (adminRidesTab) adminRidesTab.classList.add('active');
                if (adminRidesContent) adminRidesContent.classList.add('active');
                updateAdminRidesContent();
            } else if (tab === 'adminDrivers') {
                const adminDriversTab = document.getElementById('adminDriversTab');
                const adminDriversContent = document.getElementById('adminDriversContent');
                if (adminDriversTab) adminDriversTab.classList.add('active');
                if (adminDriversContent) adminDriversContent.classList.add('active');
                updateAdminDriversContent();
            } else if (tab === 'adminUsers') {
                const adminUsersTab = document.getElementById('adminUsersTab');
                const adminUsersContent = document.getElementById('adminUsersContent');
                if (adminUsersTab) adminUsersTab.classList.add('active');
                if (adminUsersContent) adminUsersContent.classList.add('active');
                updateAdminUsersContent();
            }
        }
        
        function updateRidesContent() {
            if (!currentUser) return;
            
            const rides = storage.getUserRides(currentUser.id);
            const pendingRides = rides.filter(ride => ride.status === 'pending');
            const activeRides = rides.filter(ride => ride.status === 'confirmed');
            const lastRide = rides.length > 0 ? new Date(rides[rides.length - 1].createdAt).toLocaleDateString() : '-';
            
            // Update stats
            document.getElementById('totalRides').textContent = rides.length;
            document.getElementById('activeRides').textContent = activeRides.length;
            document.getElementById('lastRide').textContent = lastRide;
            
            // Update rides history
            const ridesHistory = document.getElementById('ridesHistory');
            if (rides.length === 0) {
                ridesHistory.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-car"></i>
                        <h4>No rides yet</h4>
                        <p>Book your first ride to see your history here</p>
                        <button class="cta-button" id="bookFirstRide">Book Your First Ride</button>
                    </div>
                `;
                
                // Re-attach event listener
                const bookFirstRideBtn = document.getElementById('bookFirstRide');
                if (bookFirstRideBtn) {
                    bookFirstRideBtn.addEventListener('click', function() {
                        document.getElementById('dashboard').style.display = 'none';
                        document.querySelectorAll('section').forEach(section => {
                            section.style.display = 'block';
                        });
                        document.getElementById('calculator').scrollIntoView({ behavior: 'smooth' });
                    });
                }
            } else {
                let html = `
                    <div class="rides-table-container">
                        <table class="rides-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>From</th>
                                    <th>To</th>
                                    <th>Time</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                // Show recent rides (last 10)
                const recentRides = rides.slice(-10).reverse();
                
                recentRides.forEach(ride => {
                    const date = new Date(ride.createdAt).toLocaleDateString();
                    const statusClass = `status-${ride.status}`;
                    
                    html += `
                        <tr>
                            <td>${date}</td>
                            <td>${ride.pickup}</td>
                            <td>${ride.destination}</td>
                            <td>${ride.displayTime}</td>
                            <td><span class="status-badge ${statusClass}">${ride.status}</span></td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                ridesHistory.innerHTML = html;
            }
        }
        
        function updatePendingRidesContent() {
            if (!currentUser) return;
            
            const rides = storage.getUserRides(currentUser.id);
            const pendingRides = rides.filter(ride => ride.status === 'pending');
            
            const pendingRidesList = document.getElementById('pendingRidesList');
            if (pendingRides.length === 0) {
                pendingRidesList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-clock"></i>
                        <h4>No pending rides</h4>
                        <p>All your rides are confirmed or completed</p>
                    </div>
                `;
            } else {
                let html = `
                    <div class="rides-table-container">
                        <table class="rides-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>From</th>
                                    <th>To</th>
                                    <th>Time</th>
                                    <th>Payment</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                pendingRides.forEach(ride => {
                    const date = new Date(ride.createdAt).toLocaleDateString();
                    
                    html += `
                        <tr>
                            <td>${date}</td>
                            <td>${ride.pickup}</td>
                            <td>${ride.destination}</td>
                            <td>${ride.displayTime}</td>
                            <td>${ride.paymentMethod || 'Not specified'}</td>
                            <td><span class="status-badge status-pending">pending</span></td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                pendingRidesList.innerHTML = html;
            }
        }
        
        function loadAccountSettings() {
            if (!currentUser) return;
            
            document.getElementById('settingsName').value = currentUser.name || '';
            document.getElementById('settingsEmail').value = currentUser.email || '';
            document.getElementById('settingsPhone').value = currentUser.phone || '';
            document.getElementById('settingsAddress').value = currentUser.address || '';
            
            // Load profile picture
            const profileImg = document.getElementById('settingsProfileImg');
            const profileInitials = document.getElementById('settingsProfileInitials');
            
            if (currentUser.profilePicture) {
                profileImg.src = currentUser.profilePicture;
                profileImg.style.display = 'block';
                profileInitials.style.display = 'none';
            } else {
                profileImg.style.display = 'none';
                profileInitials.style.display = 'flex';
                profileInitials.textContent = getInitials(currentUser.name);
            }
        }
        
        function updateAdminRidesContent() {
            if (!currentUser || !currentUser.isAdmin) return;
            
            const rides = storage.getRides();
            const pendingRides = rides.filter(ride => ride.status === 'pending');
            
            const adminRidesList = document.getElementById('adminRidesList');
            if (rides.length === 0) {
                adminRidesList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-car"></i>
                        <h4>No rides to manage</h4>
                        <p>When users book rides, they will appear here</p>
                    </div>
                `;
            } else {
                let html = `
                    <div class="rides-table-container">
                        <table class="rides-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>User</th>
                                    <th>From  To</th>
                                    <th>Time</th>
                                    <th>Payment</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                // Show all rides, newest first
                const sortedRides = [...rides].reverse();
                
                sortedRides.forEach(ride => {
                    const date = new Date(ride.createdAt).toLocaleDateString();
                    const user = storage.getUserById(ride.userId);
                    const userName = user ? user.name : 'Unknown User';
                    const userAvatar = user ? (user.profilePicture || getInitials(user.name)) : '?';
                    const statusClass = `status-${ride.status}`;
                    
                    html += `
                        <tr>
                            <td>${date}</td>
                            <td>
                                <div class="user-cell">
                                    <div class="user-table-avatar">
                                        ${typeof userAvatar === 'string' && userAvatar.startsWith('data:image') 
                                            ? `<img src="${userAvatar}" class="user-table-avatar-img">`
                                            : `<div class="user-table-avatar-initials">${userAvatar}</div>`}
                                    </div>
                                    ${userName}
                                </div>
                            </td>
                            <td>${ride.pickup}  ${ride.destination}</td>
                            <td>${ride.displayTime}</td>
                            <td>${ride.paymentMethod || 'Not specified'}</td>
                            <td><span class="status-badge ${statusClass}">${ride.status}</span></td>
                            <td>
                                <div class="action-buttons">
                                    ${ride.status === 'pending' ? `
                                        <button class="action-btn accept-btn" onclick="acceptRide('${ride.id}')">
                                            <i class="fas fa-check"></i> Accept
                                        </button>
                                        <button class="action-btn decline-btn" onclick="declineRide('${ride.id}')">
                                            <i class="fas fa-times"></i> Decline
                                        </button>
                                    ` : ''}
                                    ${ride.status === 'confirmed' ? `
                                        <button class="action-btn accept-btn" onclick="completeRide('${ride.id}')">
                                            <i class="fas fa-check-circle"></i> Complete
                                        </button>
                                        <button class="action-btn cancel-btn-admin" onclick="cancelRide('${ride.id}')">
                                            <i class="fas fa-times"></i> Cancel
                                        </button>
                                    ` : ''}
                                    <button class="action-btn delete-btn" onclick="deleteRide('${ride.id}')">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                adminRidesList.innerHTML = html;
            }
        }
        
        function updateAdminDriversContent() {
            if (!currentUser || !currentUser.isAdmin) return;
            
            const drivers = storage.getDriverApplications();
            const pendingDrivers = drivers.filter(driver => driver.status === 'pending');
            
            const adminDriversList = document.getElementById('adminDriversList');
            if (drivers.length === 0) {
                adminDriversList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-users"></i>
                        <h4>No driver applications</h4>
                        <p>When drivers apply, their applications will appear here</p>
                            </div>
                `;
            } else {
                let html = `
                    <div class="rides-table-container">
                        <table class="rides-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Name</th>
                                    <th>Contact</th>
                                    <th>Vehicle</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                // Show all drivers, newest first
                const sortedDrivers = [...drivers].reverse();
                
                sortedDrivers.forEach(driver => {
                    const date = new Date(driver.createdAt).toLocaleDateString();
                    const statusClass = `status-${driver.status}`;
                    const user = storage.getUserById(driver.userId);
                    const userAvatar = user ? (user.profilePicture || getInitials(user.name)) : '?';
                    
                    html += `
                        <tr>
                            <td>${date}</td>
                            <td>
                                <div class="user-cell">
                                    <div class="user-table-avatar">
                                        ${typeof userAvatar === 'string' && userAvatar.startsWith('data:image') 
                                            ? `<img src="${userAvatar}" class="user-table-avatar-img">`
                                            : `<div class="user-table-avatar-initials">${userAvatar}</div>`}
                                    </div>
                                    ${driver.name}
                                </div>
                            </td>
                            <td>${driver.phone}<br>${driver.email}</td>
                            <td>${driver.carModel}<br>${driver.carRegistration}</td>
                            <td><span class="status-badge ${statusClass}">${driver.status}</span></td>
                            <td>
                                <div class="action-buttons">
                                    ${driver.status === 'pending' ? `
                                        <button class="action-btn accept-btn" onclick="acceptDriver('${driver.id}')">
                                            <i class="fas fa-check"></i> Accept
                                        </button>
                                        <button class="action-btn decline-btn" onclick="declineDriver('${driver.id}')">
                                            <i class="fas fa-times"></i> Decline
                                        </button>
                                    ` : ''}
                                    <button class="action-btn delete-btn" onclick="deleteDriver('${driver.id}')">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                adminDriversList.innerHTML = html;
            }
        }
        
        function updateAdminUsersContent() {
            if (!currentUser || !currentUser.isAdmin) return;
            
            const users = storage.getUsers();
            
            const adminUsersList = document.getElementById('adminUsersList');
            if (users.length === 0) {
                adminUsersList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-user-friends"></i>
                        <h4>No users registered</h4>
                        <p>User data will appear here</p>
                    </div>
                `;
            } else {
                let html = `
                    <div class="rides-table-container">
                        <table class="rides-table">
                            <thead>
                                <tr>
                                    <th>User</th>
                                    <th>Contact</th>
                                    <th>Role</th>
                                    <th>Joined</th>
                                    <th>Rides</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                // Show all users, newest first
                const sortedUsers = [...users].reverse();
                
                sortedUsers.forEach(user => {
                    const date = new Date(user.createdAt).toLocaleDateString();
                    const userRides = storage.getUserRides(user.id);
                    const userAvatar = user.profilePicture || getInitials(user.name);
                    
                    let roleBadge = '';
                    if (user.isAdmin) {
                        roleBadge = '<span class="status-badge status-confirmed">Admin</span>';
                    } else if (user.isDriver) {
                        roleBadge = '<span class="status-badge status-pending">Driver</span>';
                    } else {
                        roleBadge = '<span class="status-badge" style="background-color: rgba(59, 130, 246, 0.2); color: #3b82f6;">User</span>';
                    }
                    
                    html += `
                        <tr>
                            <td>
                                <div class="user-cell">
                                    <div class="user-table-avatar">
                                        ${typeof userAvatar === 'string' && userAvatar.startsWith('data:image') 
                                            ? `<img src="${userAvatar}" class="user-table-avatar-img">`
                                            : `<div class="user-table-avatar-initials">${userAvatar}</div>`}
                                    </div>
                                    ${user.name}
                                </div>
                            </td>
                            <td>${user.phone || 'N/A'}<br>${user.email}</td>
                            <td>${roleBadge}</td>
                            <td>${date}</td>
                            <td>${userRides.length}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn accept-btn" onclick="viewUserDetails('${user.id}')">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                    <button class="action-btn delete-btn" onclick="deleteUser('${user.id}')">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                adminUsersList.innerHTML = html;
            }
        }
        
        function loadUserDetails(userId) {
            const user = storage.getUserById(userId);
            if (!user) return;
            
            const userRides = storage.getUserRides(userId);
            const userDetailsContent = document.getElementById('userDetailsContent');
            
            const userAvatar = user.profilePicture || getInitials(user.name);
            let roleText = 'Regular User';
            if (user.isAdmin) roleText = 'Administrator';
            else if (user.isDriver) roleText = 'Driver';
            
            let html = `
                <div class="user-details-header">
                    <div class="user-details-avatar">
                        ${typeof userAvatar === 'string' && userAvatar.startsWith('data:image') 
                            ? `<img src="${userAvatar}" class="user-details-avatar-img">`
                            : `<div class="user-details-avatar-initials">${userAvatar}</div>`}
                    </div>
                    <div class="user-details-info">
                        <h3>${user.name}</h3>
                        <p>${roleText}  Joined ${new Date(user.createdAt).toLocaleDateString()}</p>
                    </div>
                </div>
                
                <div class="user-details-stats">
                    <div class="user-detail-item">
                        <div class="user-detail-label">Email</div>
                        <div class="user-detail-value">${user.email}</div>
                    </div>
                    <div class="user-detail-item">
                        <div class="user-detail-label">Phone</div>
                        <div class="user-detail-value">${user.phone || 'Not provided'}</div>
                    </div>
                    <div class="user-detail-item">
                        <div class="user-detail-label">Address</div>
                        <div class="user-detail-value">${user.address || 'Not provided'}</div>
                    </div>
                    <div class="user-detail-item">
                        <div class="user-detail-label">Total Rides</div>
                        <div class="user-detail-value">${userRides.length}</div>
                    </div>
                </div>
                
                <h3>Recent Rides</h3>
            `;
            
            if (userRides.length === 0) {
                html += `<p>No rides booked yet.</p>`;
            } else {
                html += `
                    <div class="rides-table-container">
                        <table class="rides-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>From  To</th>
                                    <th>Time</th>
                                    <th>Status</th>
                                    <th>Fare</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                const recentRides = userRides.slice(-5).reverse();
                recentRides.forEach(ride => {
                    const date = new Date(ride.createdAt).toLocaleDateString();
                    const statusClass = `status-${ride.status}`;
                    
                    html += `
                        <tr>
                            <td>${date}</td>
                            <td>${ride.pickup}  ${ride.destination}</td>
                            <td>${ride.displayTime}</td>
                            <td><span class="status-badge ${statusClass}">${ride.status}</span></td>
                            <td>${formatCurrency(ride.fare)}</td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
            }
            
            userDetailsContent.innerHTML = html;
        }
        
        // ===================== RIDE MANAGEMENT FUNCTIONS =====================
        function acceptRide(rideId) {
            if (confirm('Are you sure you want to accept this ride?')) {
                storage.updateRideStatus(rideId, 'confirmed');
                updateAdminRidesContent();
                updateNotificationBadges();
                showAlert('Ride accepted successfully', 'success');
            }
        }
        
        function declineRide(rideId) {
            if (confirm('Are you sure you want to decline this ride?')) {
                storage.updateRideStatus(rideId, 'declined');
                updateAdminRidesContent();
                updateNotificationBadges();
                showAlert('Ride declined', 'success');
            }
        }
        
        function cancelRide(rideId) {
            if (confirm('Are you sure you want to cancel this ride?')) {
                storage.updateRideStatus(rideId, 'cancelled');
                updateAdminRidesContent();
                showAlert('Ride cancelled', 'success');
            }
        }
        
        function completeRide(rideId) {
            if (confirm('Are you sure you want to mark this ride as completed?')) {
                storage.updateRideStatus(rideId, 'completed');
                updateAdminRidesContent();
                showAlert('Ride marked as completed', 'success');
            }
        }
        
        function deleteRide(rideId) {
            if (confirm('Are you sure you want to delete this ride? This action cannot be undone.')) {
                storage.deleteRide(rideId);
                updateAdminRidesContent();
                showAlert('Ride deleted successfully', 'success');
            }
        }
        
        // ===================== DRIVER MANAGEMENT FUNCTIONS =====================
        function acceptDriver(driverId) {
            if (confirm('Are you sure you want to accept this driver application?')) {
                storage.updateDriverApplicationStatus(driverId, 'accepted');
                updateAdminDriversContent();
                updateNotificationBadges();
                showAlert('Driver application accepted', 'success');
            }
        }
        
        function declineDriver(driverId) {
            if (confirm('Are you sure you want to decline this driver application?')) {
                storage.updateDriverApplicationStatus(driverId, 'declined');
                updateAdminDriversContent();
                updateNotificationBadges();
                showAlert('Driver application declined', 'success');
            }
        }
        
        function deleteDriver(driverId) {
            if (confirm('Are you sure you want to delete this driver application? This action cannot be undone.')) {
                storage.deleteDriverApplication(driverId);
                updateAdminDriversContent();
                showAlert('Driver application deleted', 'success');
            }
        }
        
        // ===================== USER MANAGEMENT FUNCTIONS =====================
        function viewUserDetails(userId) {
            openUserDetailsModal(userId);
        }
        
        function deleteUser(userId) {
            if (confirm('Are you sure you want to delete this user? This will also delete all their rides. This action cannot be undone.')) {
                // Delete user's rides
                const rides = storage.getRides();
                const userRides = rides.filter(ride => ride.userId === userId);
                userRides.forEach(ride => {
                    storage.deleteRide(ride.id);
                });
                
                // Delete user
                const users = storage.getUsers();
                const filteredUsers = users.filter(user => user.id !== userId);
                localStorage.setItem('nytRyderUsers', JSON.stringify(filteredUsers));
                
                updateAdminUsersContent();
                showAlert('User deleted successfully', 'success');
            }
        }
        
        // ===================== GOOGLE MAPS DISTANCE CALCULATION =====================
        async function calculateDistance(pickup, destination) {
            try {
                // Simulate API call delay
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Generate realistic distance based on Eastern Cape geography
                const locations = [...easternCapeLocations];
                const pickupIndex = locations.indexOf(pickup);
                const destIndex = locations.indexOf(destination);
                
                let distance;
                if (pickupIndex >= 0 && destIndex >= 0) {
                    // Calculate approximate distance based on index difference
                    distance = Math.abs(pickupIndex - destIndex) * 5 + 10;
                } else {
                    // Fallback to random distance
                    distance = 15 + Math.random() * 100;
                }
                
                // Ensure distance is reasonable
                distance = Math.min(distance, 300);
                distance = Math.max(distance, 5);
                
                return {
                    distance: distance,
                    duration: distance * 1.5, // minutes
                    status: 'OK'
                };
                
            } catch (error) {
                console.error('Distance calculation error:', error);
                // Fallback to basic calculation
                return {
                    distance: 50 + Math.random() * 100,
                    duration: 75 + Math.random() * 60,
                    status: 'ESTIMATED'
                };
            }
        }
        
        // ===================== RIDE BOOKING FUNCTIONS =====================
        async function calculateFare() {
            if (!currentUser) {
                showAlert('Please log in to book a ride', 'error');
                openAuthModal('login');
                return;
            }
            
            const pickupTime = document.getElementById('pickupTime').value;
            const pickup = document.getElementById('pickupSearch').value;
            const destination = document.getElementById('destinationSearch').value;
            const returnTrip = document.getElementById('returnTripCheck').checked;
            const waitingPeriod = document.getElementById('waitingPeriod').value;
            const paymentMethod = document.getElementById('selectedPaymentMethod').value;
            const driverInstructions = document.getElementById('driverInstructions').value;
            
            if (!pickupTime) {
                showAlert('Please select pickup time', 'error');
                return;
            }
            
            if (!pickup || !destination) {
                showAlert('Please select both pickup and destination locations', 'error');
                return;
            }
            
            if (pickup === destination) {
                showAlert('Pickup and destination cannot be the same', 'error');
                return;
            }
            
            if (!paymentMethod) {
                showAlert('Please select a payment method', 'error');
                return;
            }
            
            if (returnTrip && !waitingPeriod) {
                showAlert('Please select a waiting period for return trip', 'error');
                return;
            }
            
            // Show loading state
            const calculateBtn = document.getElementById('calculateBtn');
            const originalText = calculateBtn.innerHTML;
            calculateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Calculating...';
            calculateBtn.disabled = true;
            
            try {
                // Calculate distance
                const distanceData = await calculateDistance(pickup, destination);
                
                // Calculate fare based on distance
                // Rate: R15 per km base + R5 per km night surcharge = R20 per km
                const baseRate = 15;
                const nightSurcharge = 5;
                const ratePerKm = baseRate + nightSurcharge;
                
                // Add base fare of R50
                const baseFare = 50;
                const distanceFare = distanceData.distance * ratePerKm;
                let totalFare = baseFare + distanceFare;
                
                // Add return trip waiting fee if applicable
                let waitingFee = 0;
                if (returnTrip && waitingPeriod) {
                    const waitingMinutes = parseInt(waitingPeriod);
                    // R60 per 30 minutes
                    waitingFee = Math.ceil(waitingMinutes / 30) * 60;
                    totalFare += waitingFee;
                }
                
                // Round to nearest rand
                const roundedFare = Math.round(totalFare);
                
                // Format pickup time
                const timeParts = pickupTime.split(':');
                const hour = parseInt(timeParts[0]);
                const minute = timeParts[1];
                const ampm = hour >= 12 ? 'PM' : 'AM';
                const displayHour = hour % 12 || 12;
                const displayTime = `${displayHour}:${minute} ${ampm}`;
                
                // Update display
                document.getElementById('resultPrice').textContent = formatCurrency(roundedFare);
                document.getElementById('resultFrom').textContent = pickup;
                document.getElementById('resultTo').textContent = destination;
                document.getElementById('resultTime').textContent = displayTime;
                document.getElementById('resultDistance').textContent = `${distanceData.distance.toFixed(1)} km (${Math.round(distanceData.duration)} mins)`;
                
                document.getElementById('resultContainer').classList.add('active');
                document.getElementById('bookingConfirmation').style.display = 'block';
                
                currentRide = {
                    userId: currentUser.id,
                    pickup: pickup,
                    destination: destination,
                    pickupTime: pickupTime,
                    displayTime: displayTime,
                    distance: distanceData.distance.toFixed(1),
                    fare: roundedFare.toFixed(2),
                    estimatedTime: `${Math.round(distanceData.duration)} minutes`,
                    isReturnTrip: returnTrip,
                    waitingPeriod: waitingPeriod,
                    waitingFee: waitingFee,
                    paymentMethod: paymentMethod,
                    driverInstructions: driverInstructions,
                    createdAt: new Date().toISOString()
                };
                
                // Scroll to results
                document.getElementById('resultContainer').scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'nearest' 
                });
                
                showAlert(`Distance calculated: ${distanceData.distance.toFixed(1)} km`, 'success');
                
            } catch (error) {
                console.error('Fare calculation error:', error);
                showAlert('Error calculating fare. Please try again.', 'error');
            } finally {
                // Restore button
                calculateBtn.innerHTML = originalText;
                calculateBtn.disabled = false;
            }
        }
        
        function proceedToBooking() {
            if (!currentRide) {
                showAlert('Please calculate a fare first', 'error');
                return;
            }
            
            // Save ride to storage
            const savedRide = storage.saveRide(currentRide);
            
            // Show success modal
            const contactModal = document.getElementById('contactModal');
            if (contactModal) {
                contactModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
            
            // Hide booking confirmation
            document.getElementById('bookingConfirmation').style.display = 'none';
            
            // Update dashboard
            updateRidesContent();
            updateNotificationBadges();
            
            showAlert('Ride booked successfully! We will contact you via phone or WhatsApp.', 'success');
        }
        
        // ===================== LOCATION SEARCH =====================
        function searchLocations(query, resultsContainer, type) {
            if (!query || query.length < 1) {
                resultsContainer.classList.remove('active');
                return;
            }
            
            const searchTerm = query.toLowerCase();
            const filtered = easternCapeLocations.filter(location => 
                location.toLowerCase().includes(searchTerm)
            );
            
            resultsContainer.innerHTML = '';
            
            if (filtered.length > 0) {
                // Show all matching results
                filtered.forEach(location => {
                    const item = document.createElement('div');
                    item.className = 'location-result-item';
                    item.textContent = location;
                    item.addEventListener('click', function() {
                        if (type === 'pickup') {
                            document.getElementById('pickupSearch').value = location;
                            document.getElementById('pickupValue').value = location;
                        } else {
                            document.getElementById('destinationSearch').value = location;
                            document.getElementById('destinationValue').value = location;
                        }
                        resultsContainer.classList.remove('active');
                        
                        // Enable calculate button if all required fields are filled
                        checkCalculateButton();
                    });
                    resultsContainer.appendChild(item);
                });
                resultsContainer.classList.add('active');
            } else {
                const item = document.createElement('div');
                item.className = 'location-result-item';
                item.textContent = 'No locations found. Please try a different search term.';
                resultsContainer.appendChild(item);
                resultsContainer.classList.add('active');
            }
        }
        
        function checkCalculateButton() {
            const pickup = document.getElementById('pickupSearch').value;
            const destination = document.getElementById('destinationSearch').value;
            const pickupTime = document.getElementById('pickupTime').value;
            const paymentMethod = document.getElementById('selectedPaymentMethod').value;
            const returnTrip = document.getElementById('returnTripCheck').checked;
            const waitingPeriod = document.getElementById('waitingPeriod').value;
            const calculateBtn = document.getElementById('calculateBtn');
            
            let canCalculate = false;
            
            if (currentUser && pickup && destination && pickupTime && paymentMethod) {
                if (returnTrip) {
                    canCalculate = !!waitingPeriod;
                } else {
                    canCalculate = true;
                }
            }
            
            calculateBtn.disabled = !canCalculate;
        }
        
        // ===================== EVENT LISTENERS =====================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Nyt Ryder - Admin Login Version');
            console.log('Admin Code: 548755');
            
            // Get elements
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileNav = document.getElementById('mobileNav');
            const loginBtn = document.getElementById('loginBtn');
            const registerBtn = document.getElementById('registerBtn');
            const openDriverForm = document.getElementById('openDriverForm');
            const closeModal = document.getElementById('closeModal');
            const closeAdminModal = document.getElementById('closeAdminModal');
            const closeUserDetailsModal = document.getElementById('closeUserDetailsModal');
            const closeContactModal = document.getElementById('closeContactModal');
            const closeSuccessBtn = document.getElementById('closeSuccessBtn');
            const loginTab = document.getElementById('loginTab');
            const registerTab = document.getElementById('registerTab');
            const driverTab = document.getElementById('driverTab');
            const loginSubmitBtn = document.getElementById('loginSubmitBtn');
            const registerSubmitBtn = document.getElementById('registerSubmitBtn');
            const submitDriverBtn = document.getElementById('submitDriverBtn');
            const calculateBtn = document.getElementById('calculateBtn');
            const bookNowBtn = document.getElementById('bookNowBtn');
            const cancelBookingBtn = document.getElementById('cancelBookingBtn');
            const noticeLoginLink = document.getElementById('noticeLoginLink');
            const noticeRegisterLink = document.getElementById('noticeRegisterLink');
            const userProfile = document.getElementById('userProfile');
            const userMenu = document.getElementById('userMenu');
            const newRideBtn = document.getElementById('newRideBtn');
            const bookFirstRide = document.getElementById('bookFirstRide');
            const pickupSearch = document.getElementById('pickupSearch');
            const destinationSearch = document.getElementById('destinationSearch');
            const pickupTime = document.getElementById('pickupTime');
            const pickupResults = document.getElementById('pickupResults');
            const destinationResults = document.getElementById('destinationResults');
            const dashboardLink = document.getElementById('dashboardLink');
            const mobileDashboardLink = document.getElementById('mobileDashboardLink');
            const returnTripCheck = document.getElementById('returnTripCheck');
            const returnTripOptions = document.getElementById('returnTripOptions');
            const waitingOptions = document.querySelectorAll('.waiting-option');
            const paymentOptions = document.querySelectorAll('.payment-option');
            const saveSettingsBtn = document.getElementById('saveSettingsBtn');
            const adminLoginSubmitBtn = document.getElementById('adminLoginSubmitBtn');
            const adminLoginBtn = document.getElementById('adminLoginBtn');
            const mobileAdminBtn = document.getElementById('mobileAdminBtn');
            const headerAdminBtn = document.getElementById('headerAdminBtn');
            
            // Dashboard tabs
            const ridesTab = document.getElementById('ridesTab');
            const pendingRidesTab = document.getElementById('pendingRidesTab');
            const accountSettingsTab = document.getElementById('accountSettingsTab');
            const adminRidesTab = document.getElementById('adminRidesTab');
            const adminDriversTab = document.getElementById('adminDriversTab');
            const adminUsersTab = document.getElementById('adminUsersTab');
            
            // User menu items
            const accountInfoBtn = document.getElementById('accountInfoBtn');
            const ridesHistoryBtn = document.getElementById('ridesHistoryBtn');
            const pendingRidesBtn = document.getElementById('pendingRidesBtn');
            const accountSettingsBtn = document.getElementById('accountSettingsBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            
            // Profile picture upload elements
            const registerUploadBtn = document.getElementById('registerUploadBtn');
            const registerProfileInput = document.getElementById('registerProfileInput');
            const registerProfileImg = document.getElementById('registerProfileImg');
            const registerProfileInitials = document.getElementById('registerProfileInitials');
            
            const driverUploadBtn = document.getElementById('driverUploadBtn');
            const driverProfileInput = document.getElementById('driverProfileInput');
            const driverProfileImg = document.getElementById('driverProfileImg');
            const driverProfileInitials = document.getElementById('driverProfileInitials');
            
            const settingsUploadBtn = document.getElementById('settingsUploadBtn');
            const settingsProfileInput = document.getElementById('settingsProfileInput');
            const settingsProfileImg = document.getElementById('settingsProfileImg');
            const settingsProfileInitials = document.getElementById('settingsProfileInitials');
            
            // Initialize
            updateUI();
            
            // Mobile Menu
            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', function() {
                    mobileNav.classList.toggle('active');
                    this.innerHTML = mobileNav.classList.contains('active') 
                        ? '<i class="fas fa-times"></i>' 
                        : '<i class="fas fa-bars"></i>';
                });
            }
            
            // Close mobile menu when clicking outside
            document.addEventListener('click', function(e) {
                if (mobileNav && mobileNav.classList.contains('active') && 
                    !mobileNav.contains(e.target) && 
                    e.target !== mobileMenuBtn) {
                    mobileNav.classList.remove('active');
                    if (mobileMenuBtn) {
                        mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                    }
                }
            });
            
            // User Profile Menu
            if (userProfile) {
                userProfile.addEventListener('click', function(e) {
                    e.stopPropagation();
                    userMenu.classList.toggle('active');
                });
            }
            
            // Close user menu when clicking outside
            document.addEventListener('click', function() {
                if (userMenu && userMenu.classList.contains('active')) {
                    userMenu.classList.remove('active');
                }
            });
            
            // User Menu Items
            if (accountInfoBtn) {
                accountInfoBtn.addEventListener('click', function() {
                    userMenu.classList.remove('active');
                    showDashboard('rides');
                });
            }
            
            if (ridesHistoryBtn) {
                ridesHistoryBtn.addEventListener('click', function() {
                    userMenu.classList.remove('active');
                    showDashboard('rides');
                });
            }
            
            if (pendingRidesBtn) {
                pendingRidesBtn.addEventListener('click', function() {
                    userMenu.classList.remove('active');
                    showDashboard('pending');
                });
            }
            
            if (accountSettingsBtn) {
                accountSettingsBtn.addEventListener('click', function() {
                    userMenu.classList.remove('active');
                    showDashboard('settings');
                });
            }
            
            if (adminLoginBtn) {
                adminLoginBtn.addEventListener('click', function() {
                    userMenu.classList.remove('active');
                    openAdminModal();
                });
            }
            
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function() {
                    userMenu.classList.remove('active');
                    logoutUser();
                });
            }
            
            // Mobile Admin Login
            if (mobileAdminBtn) {
                mobileAdminBtn.addEventListener('click', function() {
                    mobileNav.classList.remove('active');
                    mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                    openAdminModal();
                });
            }
            
            // Header Admin Login
            if (headerAdminBtn) {
                headerAdminBtn.addEventListener('click', function() {
                    openAdminModal();
                });
            }
            
            // Auth Modal
            if (loginBtn) loginBtn.addEventListener('click', () => openAuthModal('login'));
            if (registerBtn) registerBtn.addEventListener('click', () => openAuthModal('register'));
            if (openDriverForm) openDriverForm.addEventListener('click', () => openAuthModal('driver'));
            if (closeModal) closeModal.addEventListener('click', closeAuthModal);
            if (closeAdminModal) closeAdminModal.addEventListener('click', closeAdminModal);
            if (closeUserDetailsModal) closeUserDetailsModal.addEventListener('click', closeUserDetailsModal);
            
            if (loginTab) loginTab.addEventListener('click', () => switchAuthTab('login'));
            if (registerTab) registerTab.addEventListener('click', () => switchAuthTab('register'));
            if (driverTab) driverTab.addEventListener('click', () => switchAuthTab('driver'));
            
            if (noticeLoginLink) noticeLoginLink.addEventListener('click', (e) => {
                e.preventDefault();
                openAuthModal('login');
            });
            
            if (noticeRegisterLink) noticeRegisterLink.addEventListener('click', (e) => {
                e.preventDefault();
                openAuthModal('register');
            });
            
            // Profile Picture Upload - Register
            if (registerUploadBtn) {
                registerUploadBtn.addEventListener('click', function() {
                    registerProfileInput.click();
                });
            }
            
            if (registerProfileInput) {
                registerProfileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        if (file.size > 2 * 1024 * 1024) {
                            showAlert('File size must be less than 2MB', 'error');
                            return;
                        }
                        
                        compressImage(file).then(blob => {
                            const reader = new FileReader();
                            reader.onload = function(event) {
                                registerProfileImg.src = event.target.result;
                                registerProfileImg.style.display = 'block';
                                registerProfileInitials.style.display = 'none';
                            };
                            reader.readAsDataURL(blob);
                        }).catch(error => {
                            showAlert('Error processing image', 'error');
                        });
                    }
                });
            }
            
            // Profile Picture Upload - Driver
            if (driverUploadBtn) {
                driverUploadBtn.addEventListener('click', function() {
                    driverProfileInput.click();
                });
            }
            
            if (driverProfileInput) {
                driverProfileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        if (file.size > 2 * 1024 * 1024) {
                            showAlert('File size must be less than 2MB', 'error');
                            return;
                        }
                        
                        compressImage(file).then(blob => {
                            const reader = new FileReader();
                            reader.onload = function(event) {
                                driverProfileImg.src = event.target.result;
                                driverProfileImg.style.display = 'block';
                                driverProfileInitials.style.display = 'none';
                            };
                            reader.readAsDataURL(blob);
                        }).catch(error => {
                            showAlert('Error processing image', 'error');
                        });
                    }
                });
            }
            
            // Profile Picture Upload - Settings
            if (settingsUploadBtn) {
                settingsUploadBtn.addEventListener('click', function() {
                    settingsProfileInput.click();
                });
            }
            
            if (settingsProfileInput) {
                settingsProfileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        if (file.size > 2 * 1024 * 1024) {
                            showAlert('File size must be less than 2MB', 'error');
                            return;
                        }
                        
                        compressImage(file).then(blob => {
                            const reader = new FileReader();
                            reader.onload = function(event) {
                                settingsProfileImg.src = event.target.result;
                                settingsProfileImg.style.display = 'block';
                                settingsProfileInitials.style.display = 'none';
                                currentUser.profilePicture = event.target.result;
                                updateUserAvatar();
                            };
                            reader.readAsDataURL(blob);
                        }).catch(error => {
                            showAlert('Error processing image', 'error');
                        });
                    }
                });
            }
            
            // Login Form
            if (loginSubmitBtn) {
                loginSubmitBtn.addEventListener('click', function() {
                    const email = document.getElementById('loginEmail').value;
                    const password = document.getElementById('loginPassword').value;
                    
                    if (!email || !password) {
                        showAlert('Please enter both email and password', 'error');
                        return;
                    }
                    
                    const user = storage.getUserByEmail(email);
                    
                    if (!user) {
                        showAlert('No account found with this email', 'error');
                        return;
                    }
                    
                    // In real app, you would hash and compare passwords
                    // For demo, we'll use simple check
                    if (user.password !== password) {
                        showAlert('Incorrect password', 'error');
                        return;
                    }
                    
                    loginUser(user);
                });
            }
            
            // Register Form
            if (registerSubmitBtn) {
                registerSubmitBtn.addEventListener('click', function() {
                    const name = document.getElementById('registerName').value;
                    const phone = document.getElementById('registerPhone').value;
                    const email = document.getElementById('registerEmail').value;
                    const password = document.getElementById('registerPassword').value;
                    const address = document.getElementById('registerAddress').value;
                    
                    if (!name || !phone || !email || !password) {
                        showAlert('Please fill in all required fields', 'error');
                        return;
                    }
                    
                    if (!isValidEmail(email)) {
                        showAlert('Please enter a valid email address', 'error');
                        return;
                    }
                    
                    if (phone.length < 9) {
                        showAlert('Please enter a valid South African phone number', 'error');
                        return;
                    }
                    
                    if (password.length < 6) {
                        showAlert('Password must be at least 6 characters', 'error');
                        return;
                    }
                    
                    // Check if user already exists
                    const existingUser = storage.getUserByEmail(email);
                    if (existingUser) {
                        showAlert('An account with this email already exists. Please log in.', 'error');
                        return;
                    }
                    
                    const newUser = {
                        name,
                        phone,
                        email,
                        password,
                        address
                    };
                    
                    // Add profile picture if uploaded
                    if (registerProfileImg.src && registerProfileImg.style.display === 'block') {
                        newUser.profilePicture = registerProfileImg.src;
                    }
                    
                    const savedUser = storage.saveUser(newUser);
                    storage.setCurrentUser(savedUser);
                    currentUser = savedUser;
                    
                    showAlert('Registration successful!', 'success');
                    updateUI();
                    closeAuthModal();
                });
            }
            
            // Driver Application
            if (submitDriverBtn) {
                submitDriverBtn.addEventListener('click', function() {
                    const name = document.getElementById('driverName').value;
                    const id = document.getElementById('driverId').value;
                    const phone = document.getElementById('driverPhone').value;
                    const email = document.getElementById('driverEmail').value;
                    const password = document.getElementById('driverPassword').value;
                    const address = document.getElementById('driverAddress').value;
                    const license = document.getElementById('driverLicense').value;
                    const carModel = document.getElementById('carModel').value;
                    const carRegistration = document.getElementById('carRegistration').value;
                    const carColor = document.getElementById('carColor').value;
                    const criminalCheck = document.getElementById('criminalCheck').checked;
                    const ownerCheck = document.getElementById('ownerCheck').checked;
                    const termsCheck = document.getElementById('termsCheck').checked;
                    
                    if (!name || !id || !phone || !email || !password || !address || !license || !carModel || !carRegistration || !carColor) {
                        showAlert('Please fill in all required fields', 'error');
                        return;
                    }
                    
                    if (!criminalCheck || !ownerCheck || !termsCheck) {
                        showAlert('Please agree to all terms and conditions', 'error');
                        return;
                    }
                    
                    // Create driver user
                    const driverUser = {
                        name,
                        phone,
                        email,
                        password,
                        address,
                        isDriver: false // Will be set to true when accepted by admin
                    };
                    
                    // Add profile picture if uploaded
                    if (driverProfileImg.src && driverProfileImg.style.display === 'block') {
                        driverUser.profilePicture = driverProfileImg.src;
                    }
                    
                    const savedUser = storage.saveUser(driverUser);
                    
                    // Save driver application
                    const driverApplication = {
                        userId: savedUser.id,
                        name,
                        id,
                        phone,
                        email,
                        address,
                        license,
                        carModel,
                        carRegistration,
                        carColor,
                        status: 'pending',
                        appliedAt: new Date().toISOString()
                    };
                    
                    storage.saveDriverApplication(driverApplication);
                    
                    // Log in as driver applicant
                    storage.setCurrentUser(savedUser);
                    currentUser = savedUser;
                    
                    showAlert('Driver application submitted successfully! We will review your application and contact you soon.', 'success');
                    updateUI();
                    closeAuthModal();
                });
            }
            
            // Admin Login
            if (adminLoginSubmitBtn) {
                adminLoginSubmitBtn.addEventListener('click', adminLogin);
            }
            
            // Enter key for admin login
            document.getElementById('adminCode')?.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    adminLogin();
                }
            });
            
            // Booking Functions
            if (calculateBtn) calculateBtn.addEventListener('click', calculateFare);
            if (bookNowBtn) bookNowBtn.addEventListener('click', proceedToBooking);
            
            if (cancelBookingBtn) {
                cancelBookingBtn.addEventListener('click', function() {
                    document.getElementById('bookingConfirmation').style.display = 'none';
                });
            }
            
            // Dashboard Functions
            if (newRideBtn) {
                newRideBtn.addEventListener('click', function() {
                    document.getElementById('dashboard').style.display = 'none';
                    document.querySelectorAll('section').forEach(section => {
                        section.style.display = 'block';
                    });
                    document.getElementById('calculator').scrollIntoView({ behavior: 'smooth' });
                });
            }
            
            if (dashboardLink) {
                dashboardLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    showDashboard();
                });
            }
            
            if (mobileDashboardLink) {
                mobileDashboardLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    mobileNav.classList.remove('active');
                    mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                    showDashboard();
                });
            }
            
            // Dashboard Tabs
            if (ridesTab) ridesTab.addEventListener('click', () => switchDashboardTab('rides'));
            if (pendingRidesTab) pendingRidesTab.addEventListener('click', () => switchDashboardTab('pending'));
            if (accountSettingsTab) accountSettingsTab.addEventListener('click', () => switchDashboardTab('settings'));
            if (adminRidesTab) adminRidesTab.addEventListener('click', () => switchDashboardTab('adminRides'));
            if (adminDriversTab) adminDriversTab.addEventListener('click', () => switchDashboardTab('adminDrivers'));
            if (adminUsersTab) adminUsersTab.addEventListener('click', () => switchDashboardTab('adminUsers'));
            
            // Contact Modal
            if (closeContactModal) {
                closeContactModal.addEventListener('click', function() {
                    document.getElementById('contactModal').classList.remove('active');
                    document.body.style.overflow = 'auto';
                });
            }
            
            if (closeSuccessBtn) {
                closeSuccessBtn.addEventListener('click', function() {
                    document.getElementById('contactModal').classList.remove('active');
                    document.body.style.overflow = 'auto';
                    updateRidesContent();
                    showDashboard();
                });
            }
            
            // Location Search
            if (pickupSearch) {
                pickupSearch.addEventListener('input', function() {
                    searchLocations(this.value, pickupResults, 'pickup');
                });
                
                // Clear search when field is cleared
                pickupSearch.addEventListener('change', function() {
                    if (!this.value) {
                        document.getElementById('pickupValue').value = '';
                        checkCalculateButton();
                    }
                });
            }
            
            if (destinationSearch) {
                destinationSearch.addEventListener('input', function() {
                    searchLocations(this.value, destinationResults, 'destination');
                });
                
                // Clear search when field is cleared
                destinationSearch.addEventListener('change', function() {
                    if (!this.value) {
                        document.getElementById('destinationValue').value = '';
                        checkCalculateButton();
                    }
                });
            }
            
            // Return Trip Options
            if (returnTripCheck) {
                returnTripCheck.addEventListener('change', function() {
                    if (this.checked) {
                        returnTripOptions.classList.add('active');
                    } else {
                        returnTripOptions.classList.remove('active');
                        document.getElementById('waitingPeriod').value = '';
                    }
                    checkCalculateButton();
                });
            }
            
            // Waiting Options
            waitingOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove selected class from all options
                    waitingOptions.forEach(opt => opt.classList.remove('selected'));
                    // Add selected class to clicked option
                    this.classList.add('selected');
                    // Set waiting period value
                    const minutes = this.getAttribute('data-minutes');
                    document.getElementById('waitingPeriod').value = minutes;
                    checkCalculateButton();
                });
            });
            
            // Payment Options
            paymentOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove selected class from all options
                    paymentOptions.forEach(opt => opt.classList.remove('selected'));
                    // Add selected class to clicked option
                    this.classList.add('selected');
                    // Set payment method value
                    const method = this.getAttribute('data-method');
                    document.getElementById('selectedPaymentMethod').value = method;
                    checkCalculateButton();
                });
            });
            
            // Enable calculate button when all fields are filled
            if (pickupTime) {
                pickupTime.addEventListener('change', checkCalculateButton);
            }
            
            // Account Settings
            if (saveSettingsBtn) {
                saveSettingsBtn.addEventListener('click', function() {
                    const email = document.getElementById('settingsEmail').value;
                    const phone = document.getElementById('settingsPhone').value;
                    const address = document.getElementById('settingsAddress').value;
                    const currentPassword = document.getElementById('currentPassword').value;
                    const newPassword = document.getElementById('newPassword').value;
                    const confirmPassword = document.getElementById('confirmPassword').value;
                    
                    if (!email) {
                        showAlert('Please enter your email address', 'error');
                        return;
                    }
                    
                    if (!isValidEmail(email)) {
                        showAlert('Please enter a valid email address', 'error');
                        return;
                    }
                    
                    // Check if email is already taken by another user
                    const existingUser = storage.getUserByEmail(email);
                    if (existingUser && existingUser.id !== currentUser.id) {
                        showAlert('This email is already registered to another account', 'error');
                        return;
                    }
                    
                    // Check if changing password
                    if (currentPassword || newPassword || confirmPassword) {
                        if (!currentPassword) {
                            showAlert('Please enter your current password to change password', 'error');
                            return;
                        }
                        
                        if (!newPassword) {
                            showAlert('Please enter new password', 'error');
                            return;
                        }
                        
                        if (newPassword.length < 6) {
                            showAlert('New password must be at least 6 characters', 'error');
                            return;
                        }
                        
                        if (newPassword !== confirmPassword) {
                            showAlert('New passwords do not match', 'error');
                            return;
                        }
                        
                        // Verify current password
                        if (currentUser.password !== currentPassword) {
                            showAlert('Current password is incorrect', 'error');
                            return;
                        }
                        
                        // Update password
                        currentUser.password = newPassword;
                    }
                    
                    // Update user details
                    currentUser.email = email;
                    currentUser.phone = phone;
                    currentUser.address = address;
                    
                    // Save updated user
                    storage.saveUser(currentUser);
                    storage.setCurrentUser(currentUser);
                    
                    // Clear password fields
                    document.getElementById('currentPassword').value = '';
                    document.getElementById('newPassword').value = '';
                    document.getElementById('confirmPassword').value = '';
                    
                    showAlert('Account settings updated successfully!', 'success');
                });
            }
            
            // Close search results when clicking outside
            document.addEventListener('click', function(e) {
                if (pickupSearch && !pickupSearch.contains(e.target) && pickupResults && !pickupResults.contains(e.target)) {
                    pickupResults.classList.remove('active');
                }
                if (destinationSearch && !destinationSearch.contains(e.target) && destinationResults && !destinationResults.contains(e.target)) {
                    destinationResults.classList.remove('active');
                }
            });
            
            // Smooth scrolling for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    
                    if (href === '#dashboard') return; // Handled separately
                    if (href === '#') return;
                    
                    const targetElement = document.querySelector(href);
                    if (targetElement) {
                        e.preventDefault();
                        
                        // Hide dashboard if showing
                        document.getElementById('dashboard').style.display = 'none';
                        document.querySelectorAll('section').forEach(section => {
                            if (section.id !== 'dashboard') {
                                section.style.display = 'block';
                            }
                        });
                        
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                        
                        // Close mobile menu
                        if (mobileNav.classList.contains('active')) {
                            mobileNav.classList.remove('active');
                            mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                        }
                    }
                });
            });
            
            // Close modals when clicking outside
            document.addEventListener('click', function(e) {
                const authModal = document.getElementById('authModal');
                const adminModal = document.getElementById('adminModal');
                const contactModal = document.getElementById('contactModal');
                const userDetailsModal = document.getElementById('userDetailsModal');
                
                if (authModal && e.target === authModal) {
                    closeAuthModal();
                }
                
                if (adminModal && e.target === adminModal) {
                    closeAdminModal();
                }
                
                if (contactModal && e.target === contactModal) {
                    contactModal.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }
                
                if (userDetailsModal && e.target === userDetailsModal) {
                    closeUserDetailsModal();
                }
            });
            
            // Escape key to close modals
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeAuthModal();
                    closeAdminModal();
                    closeUserDetailsModal();
                    
                    const contactModal = document.getElementById('contactModal');
                    if (contactModal && contactModal.classList.contains('active')) {
                        contactModal.classList.remove('active');
                        document.body.style.overflow = 'auto';
                    }
                    
                    // Close user menu
                    if (userMenu && userMenu.classList.contains('active')) {
                        userMenu.classList.remove('active');
                    }
                    
                    // Close mobile menu
                    if (mobileNav && mobileNav.classList.contains('active')) {
                        mobileNav.classList.remove('active');
                        mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                    }
                }
            });
            
            // Clear test data from forms
            document.getElementById('loginEmail').value = '';
            document.getElementById('loginPassword').value = '';
            document.getElementById('registerName').value = '';
            document.getElementById('registerPhone').value = '';
            document.getElementById('registerEmail').value = '';
            document.getElementById('registerPassword').value = '';
            document.getElementById('registerAddress').value = '';
        });
    </script>
</body>
</html>
